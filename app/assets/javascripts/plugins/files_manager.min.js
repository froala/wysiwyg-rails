/*!
 * froala_editor v3.1.0 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2020 Froala Labs
 */

!function (e, t) { "object" == typeof exports && "undefined" != typeof module ? t(require("froala-editor")) : "function" == typeof define && define.amd ? define(["froala-editor"], t) : t(e.FroalaEditor) }(this, function (_t) { "use strict"; function Dt(e) { return (Dt = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } _t = _t && _t.hasOwnProperty("default") ? _t["default"] : _t, Object.assign(_t.POPUP_TEMPLATES, { "filesManager.insert": "[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_EMBED_LAYER_][_UPLOAD_PROGRESS_LAYER_][_PROGRESS_BAR_]", "image.edit": "[_BUTTONS_]", "image.alt": "[_BUTTONS_][_ALT_LAYER_]", "image.size": "[_BUTTONS_][_SIZE_LAYER_]" }), Object.assign(_t.DEFAULTS, { filesInsertButtons: ["imageBack", "|", "filesUpload", "filesByURL", "filesEmbed"], filesInsertButtons2: ["deleteAll", "insertAll", "cancel", "minimize"], imageEditButtons: ["imageReplace", "imageAlign", "imageCaption", "imageRemove", "imageLink", "linkOpen", "linkEdit", "linkRemove", "-", "imageDisplay", "imageStyle", "imageAlt", "imageSize"], imageAltButtons: ["imageBack", "|"], imageSizeButtons: ["imageBack", "|"], imageUpload: !0, filesManagerUploadURL: null, imageCORSProxy: "https://cors-anywhere.froala.com", imageUploadRemoteUrls: !0, filesManagerUploadParam: "file", filesManagerUploadParams: {}, googleOptions: {}, filesManagerUploadToS3: !1, filesManagerUploadMethod: "POST", filesManagerMaxSize: 10485760, filesManagerAllowedTypes: ["*"], imageResize: !0, imageResizeWithPercent: !1, imageRoundPercent: !1, imageDefaultWidth: 300, imageDefaultAlign: "center", imageDefaultDisplay: "block", imageSplitHTML: !1, imageStyles: { "fr-rounded": "Rounded", "fr-bordered": "Bordered", "fr-shadow": "Shadow" }, imageMove: !0, imageMultipleStyles: !0, imageTextNear: !0, imagePaste: !0, imagePasteProcess: !1, imageMinWidth: 16, imageOutputSize: !1, imageDefaultMargin: 5, imageAddNewLine: !1 }), _t.VIDEO_PROVIDERS = [{ test_regex: /^.*((youtu.be)|(youtube.com))\/((v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))?\??v?=?([^#\&\?]*).*/, url_regex: /(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g, url_text: "https://www.youtube.com/embed/$1?$2", html: '<iframe width="640" height="360" src="{url}&wmode=opaque" frameborder="0" allowfullscreen></iframe>', provider: "youtube" }, { test_regex: /^.*(?:vimeo.com)\/(?:channels(\/\w+\/)?|groups\/*\/videos\/\u200b\d+\/|video\/|)(\d+)(?:$|\/|\?)/, url_regex: /(?:https?:\/\/)?(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?(\/[a-zA-Z0-9_\-]+)?/i, url_text: "https://player.vimeo.com/video/$1", html: '<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>', provider: "vimeo" }, { test_regex: /^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/, url_regex: /(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g, url_text: "https://www.dailymotion.com/embed/video/$1", html: '<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>', provider: "dailymotion" }, { test_regex: /^.+(screen.yahoo.com)\/[^_&]+/, url_regex: "", url_text: "", html: '<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>', provider: "yahoo" }, { test_regex: /^.+(rutube.ru)\/[^_&]+/, url_regex: /(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g, url_text: "https://rutube.ru/play/embed/$1", html: '<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>', provider: "rutube" }, { test_regex: /^(?:.+)vidyard.com\/(?:watch)?\/?([^.&/]+)\/?(?:[^_.&]+)?/, url_regex: /^(?:.+)vidyard.com\/(?:watch)?\/?([^.&/]+)\/?(?:[^_.&]+)?/g, url_text: "https://play.vidyard.com/$1", html: '<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>', provider: "vidyard" }], _t.VIDEO_EMBED_REGEX = /^\W*((<iframe(.|\n)*>(\s|\n)*<\/iframe>)|(<embed(.|\n)*>))\W*$/i, _t.IMAGE_EMBED_REGEX = /^\W*((<img(.|\n)*>(\s|\n)*))\W*$/i, _t.PLUGINS.filesManager = function (k) { var h, s, I, l, d, f, o, A = k.$, p = "https://i.froala.com/upload", c = !1, t = !1, L = new Map, _ = new Map, g = new Map, u = new Map, D = new Map, m = new Map, r = 0, a = [], v = -1, S = [], b = 0, y = ["file", "image", "imageTUI", "video"], B = 1, w = 2, x = 3, E = 4, M = 5, C = 6, R = 10, O = ["video/avi", "video/mpeg", "video/x-ms-wmv"], T = {}; function $() { var e = k.popups.get("filesManager.insert"), t = e.find(".fr-files-by-url-layer input"); t.val(""), e.find(".fr-files-embed-layer textarea").val("").trigger("change"), t.trigger("change") } function U(e) { var t; m.forEach(function (e, t) { j(t) }), z() ? (t = k.popups.get("filesManager.insert")) || (t = Fe()) : (t = k.popups.get("filesManager.insert")) || (t = function s() { var e = '<div class="fr-buttons fr-tabs">'.concat(k.button.buildList(k.opts.fileInsertButtons), "</div>"), t = "<div style= 'padding:10px'>\n    <div class = 'fr-message'><h3 style ='font-size: 16px; margin: 10px 10px;font-weight: normal;'>".concat(k.language.translate(function a() { var e = "", t = function i() { var t = []; return y.forEach(function (e) { k.opts.pluginsEnabled.indexOf(e) < 0 && t.push(e.charAt(0).toUpperCase() + e.slice(1)) }), t }(); e = t.join(", "), 1 < t.length ? e += " plugin are" : e += " plugin is"; return e }() + " not enabled. Do you want to enable?"), "</h3></div>\n    <div style='text-align:right;'>\n      <button class='fr-trim-button fr-plugins-enable'>").concat(k.language.translate("Enable"), "</button>               \n      <button class='fr-trim-button fr-plugins-cancel'>").concat(k.language.translate("Cancel"), "</button>\n    </div>"), i = { buttons: e, upload_layer: t, by_url_layer: "", embed_layer: "", upload_progress_layer: "", progress_bar: "" }, n = k.popups.create("filesManager.insert", i); return Oe(n), n }()); var i = k.$tb.find('.fr-command[data-cmd="insertFiles"]'); if (Q(), e || !t.hasClass("fr-active")) if (e || q(), k.popups.refresh("filesManager.insert"), k.popups.setContainer("filesManager.insert", k.$tb), i.isVisible()) { var n = k.button.getPosition(i, L.size), a = n.left, r = n.top; k.popups.show("filesManager.insert", a, r, i.outerHeight()) } else k.position.forSelection(t), k.popups.show("filesManager.insert"); k.popups.setPopupDimensions(t), z() && k.popups.setFileListHeight(t), t.find(".fr-upload-progress") && 0 == L.size && t.find(".fr-upload-progress").addClass("fr-none") } function z() { var t = !0; return y.forEach(function (e) { k.opts.pluginsEnabled.indexOf(e) < 0 && (t = !1) }), t } function P() { Q() } function N() { if (l || function s() { var e; k.shared.$image_resizer ? (l = k.shared.$image_resizer, f = k.shared.$img_overlay, k.events.on("destroy", function () { A("body").first().append(l.removeClass("fr-active")) }, !0)) : (k.shared.$image_resizer = A(document.createElement("div")).attr("class", "fr-image-resizer"), l = k.shared.$image_resizer, k.events.$on(l, "mousedown", function (e) { e.stopPropagation() }, !0), k.opts.imageResize && (l.append(F("nw") + F("ne") + F("sw") + F("se")), k.shared.$img_overlay = A(document.createElement("div")).attr("class", "fr-image-overlay"), f = k.shared.$img_overlay, e = l.get(0).ownerDocument, A(e).find("body").first().append(f))); k.events.on("shared.destroy", function () { l.html("").removeData().remove(), l = null, k.opts.imageResize && (f.remove(), f = null) }, !0), k.helpers.isMobile() || k.events.$on(A(k.o_win), "resize", function () { h && !h.hasClass("fr-uploading") ? at(!0) : h && (N(), replace(), Z(!1)) }); if (k.opts.imageResize) { e = l.get(0).ownerDocument, k.events.$on(l, k._mousedown, ".fr-handler", K), k.events.$on(A(e), k._mousemove, V), k.events.$on(A(e.defaultView || e.parentWindow), k._mouseup, W), k.events.$on(f, "mouseleave", W); var n = 1, a = null, r = 0; k.events.on("keydown", function (e) { if (h) { var t = -1 != navigator.userAgent.indexOf("Mac OS X") ? e.metaKey : e.ctrlKey, i = e.which; (i !== a || 200 < e.timeStamp - r) && (n = 1), (i == _t.KEYCODE.EQUALS || k.browser.mozilla && i == _t.KEYCODE.FF_EQUALS) && t && !e.altKey ? n = je.call(this, e, 1, 1, n) : (i == _t.KEYCODE.HYPHEN || k.browser.mozilla && i == _t.KEYCODE.FF_HYPHEN) && t && !e.altKey ? n = je.call(this, e, 2, -1, n) : k.keys.ctrlKey(e) || i != _t.KEYCODE.ENTER || (h.before("<br>"), Me(h)), a = i, r = e.timeStamp } }, !0), k.events.on("keyup", function () { n = 1 }) } }(), !h) return !1; var e = k.$wp || k.$sc; e.append(l), l.data("instance", k); var t = e.scrollTop() - ("static" != e.css("position") ? e.offset().top : 0), i = e.scrollLeft() - ("static" != e.css("position") ? e.offset().left : 0); i -= k.helpers.getPX(e.css("border-left-width")), t -= k.helpers.getPX(e.css("border-top-width")), k.$el.is("img") && k.$sc.is("body") && (i = t = 0); var n = ft(); ct() && (n = n.find(".fr-img-wrap")); var a = 0, r = 0; k.opts.iframe && (a = k.helpers.getPX(k.$wp.find(".fr-iframe").css("padding-top")), r = k.helpers.getPX(k.$wp.find(".fr-iframe").css("padding-left"))), l.css("top", (k.opts.iframe ? n.offset().top + a : n.offset().top + t) - 1).css("left", (k.opts.iframe ? n.offset().left + r : n.offset().left + i) - 1).css("width", n.get(0).getBoundingClientRect().width).css("height", n.get(0).getBoundingClientRect().height).addClass("fr-active") } function F(e) { return '<div class="fr-handler fr-h'.concat(e, '"></div>') } function H(e) { ct() ? h.parents(".fr-img-caption").css("width", e) : h.css("width", e) } function K(e) { if (!k.core.sameInstance(l)) return !0; if (e.preventDefault(), e.stopPropagation(), k.$el.find("img.fr-error").left) return !1; k.undo.canDo() || k.undo.saveStep(); var t = e.pageX || e.originalEvent.touches[0].pageX; if ("mousedown" == e.type) { var i = k.$oel.get(0).ownerDocument, n = i.defaultView || i.parentWindow, a = !1; try { a = n.location != n.parent.location && !(n.$ && n.$.FE) } catch (o) { } a && n.frameElement && (t += k.helpers.getPX(A(n.frameElement).offset().left) + n.frameElement.clientLeft) } (d = A(this)).data("start-x", t), d.data("start-width", h.width()), d.data("start-height", h.height()); var r = h.width(); if (k.opts.imageResizeWithPercent) { var s = h.parentsUntil(k.$el, k.html.blockTagsQuery()).get(0) || k.el; r = (r / A(s).outerWidth() * 100).toFixed(2) + "%" } H(r), f.show(), k.popups.hideAll(), ot() } function V(e) { if (!k.core.sameInstance(l)) return !0; var t; if (d && h) { if (e.preventDefault(), k.$el.find("img.fr-error").left) return !1; var i = e.pageX || (e.originalEvent.touches ? e.originalEvent.touches[0].pageX : null); if (!i) return !1; var n = i - d.data("start-x"), a = d.data("start-width"); if ((d.hasClass("fr-hnw") || d.hasClass("fr-hsw")) && (n = 0 - n), k.opts.imageResizeWithPercent) { var r = h.parentsUntil(k.$el, k.html.blockTagsQuery()).get(0) || k.el; a = ((a + n) / A(r).outerWidth() * 100).toFixed(2), k.opts.imageRoundPercent && (a = Math.round(a)), H("".concat(a, "%")), (t = ct() ? (k.helpers.getPX(h.parents(".fr-img-caption").css("width")) / A(r).outerWidth() * 100).toFixed(2) : (k.helpers.getPX(h.css("width")) / A(r).outerWidth() * 100).toFixed(2)) === a || k.opts.imageRoundPercent || H("".concat(t, "%")), h.css("height", "").removeAttr("height") } else a + n >= k.opts.imageMinWidth && (H(a + n), t = ct() ? k.helpers.getPX(h.parents(".fr-img-caption").css("width")) : k.helpers.getPX(h.css("width"))), t !== a + n && H(t), ((h.attr("style") || "").match(/(^height:)|(; *height:)/) || h.attr("height")) && (h.css("height", d.data("start-height") * h.width() / d.data("start-width")), h.removeAttr("height")); N(), k.events.trigger("image.resize", [dt()]) } } function W(e) { if (!k.core.sameInstance(l)) return !0; if (d && h) { if (e && e.stopPropagation(), k.$el.find("img.fr-error").left) return !1; d = null, f.hide(), N(), k.undo.saveStep(), k.events.trigger("image.resizeEnd", [dt()]) } else l.removeClass("fr-active") } function Y() { m.forEach(function (e, t) { var i = k.popups.get("filesManager.insert"); i.find(".fr-checkbox-file-" + t).get(0).disabled = !0, document.getElementById("fr-file-autoplay-button-" + t) && (document.getElementById("fr-file-autoplay-button-" + t).disabled = !0, document.getElementById("fr-file-autoplay-button-" + t).parentElement.classList.add("fr-checkbox-disabled"), document.getElementById("fr-file-autoplay-button-" + t).parentElement.classList.remove("fr-files-checkbox")), i.find(".fr-checkbox-" + t).get(0).classList.remove("fr-files-checkbox"), i.find(".fr-checkbox-" + t).get(0).classList.add("fr-checkbox-disabled") }) } function G(e, t, i, n) { k.edit.on(), h && h.addClass("fr-error"), T[e] ? (e != x && e != w && e != E || we(100, n, !0), m.set(n, T[e]), Y(), function a() { m.forEach(function (e, t) { k.popups.get("filesManager.insert"), document.getElementById("fr-file-edit-button-".concat(t)) && (document.getElementById("fr-file-edit-button-".concat(t)).classList.add("fr-disabled"), document.getElementById("fr-file-view-button-".concat(t)).classList.add("fr-disabled"), document.getElementById("fr-file-insert-button-".concat(t)).classList.add("fr-disabled")) }) }(), te(k.language.translate(T[e]), n)) : te(k.language.translate("Something went wrong. Please try again."), n), !h && i && qe(i), k.events.trigger("filesManager.error", [{ code: e, message: T[e] }, t, i]) } function X() { var e = k.popups.get("filesManager.insert"), t = e.find('.fr-command[data-cmd="insertAll"]'), i = e.find('.fr-command[data-cmd="deleteAll"]'), n = !0; D.forEach(function a(e, t, i) { D.get(t) && (n = !1) }), n ? t.addClass("fr-disabled") : t.removeClass("fr-disabled"), n ? i.addClass("fr-disabled") : i.removeClass("fr-disabled") } function j(e) { _.get(e) && _.get(e).link && k.events.trigger("filesManager.removed", [_.get(e).link]); var t = k.popups.get("filesManager.insert"); t.find(".fr-file-" + e).get(0) !== undefined && (t.find(".fr-file-" + e).get(0).outerHTML = ""), _["delete"](e), L["delete"](e), D["delete"](e), X(), 0 == L.size && (b = 0), m["delete"](e), k.popups.setPopupDimensions(t, !0), k.opts.toolbarBottom ? U(!0) : k.popups.setPopupDimensions(t), t.find(".fr-upload-progress") && 0 == L.size && t.find(".fr-upload-progress").addClass("fr-none") } function q() { for (var e = k.popups.get("filesManager.insert"), t = e.find(".fr-insert-checkbox"), i = 0; i < t.length; i++)t.get(i).children.target.checked = !1, e.find(".fr-file-" + t.get(i).id.split("-").pop()).get(0).classList.add("fr-unchecked"); if (I) document.getElementById("fr-file-autoplay-button-".concat(I)) && (document.getElementById("fr-file-autoplay-button-".concat(I)).checked = !1), S = S.filter(function (e) { return e != I }); else { for (var n = e.find(".fr-file-autoplay-button"), a = 0; a < n.length; a++)n.get(a).checked = !1; S = [] } D = new Map, X() } function Z(e) { var t = k.popups.get("filesManager.insert"); if (t || (t = Fe()), t.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"), t.find(".fr-files-progress-bar-layer").addClass("fr-active"), t.find(".fr-buttons").hide(), h) { var i = ft(); k.popups.setContainer("filesManager.insert", k.$sc); var n = i.offset().left, a = i.offset().top + i.height(); k.popups.show("filesManager.insert", n, a, i.outerHeight()) } void 0 === e && J(k.language.translate("Uploading"), 0) } function Q(e) { var t = k.popups.get("filesManager.insert"); if (t && (t.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"), t.find(".fr-files-progress-bar-layer").removeClass("fr-active"), t.find(".fr-buttons").show(), e || k.$el.find("img.fr-error").length)) { if (k.events.focus(), k.$el.find("img.fr-error").length && (k.$el.find("img.fr-error").remove(), k.undo.saveStep(), k.undo.run(), k.undo.dropRedo()), !k.$wp && h) { var i = h; at(!0), k.selection.setAfter(i.get(0)), k.selection.restore() } k.popups.hide("filesManager.insert") } } function J(e, t) { var i = k.popups.get("filesManager.insert"); if (i) { var n = i.find(".fr-files-progress-bar-layer"); n.find("h3").text(e + (t ? " ".concat(t, "%") : "")), n.removeClass("fr-error"), t ? (n.find("div").removeClass("fr-indeterminate"), n.find("div > span").css("width", "".concat(t, "%"))) : n.find("div").addClass("fr-indeterminate") } } function ee(e) { Z(); var t = k.popups.get("filesManager.insert").find(".fr-files-progress-bar-layer"); t.addClass("fr-error"); var i = t.find("h3"); i.text(e), k.events.disableBlur(), i.focus() } function te(e, t) { var i = k.popups.get("filesManager.insert"), n = i.find(".fr-upload-progress-layer"), a = i.find(".fr-file-".concat(t)); n.addClass("fr-error"), a.find("h5").text(e) } T[B] = "File cannot be loaded from the passed link.", T[w] = "No link in upload response.", T[x] = "Error during file upload.", T[E] = "Parsing response failed.", T[M] = "File is too large.", T[C] = "File type is invalid.", T[7] = "Files can be uploaded only to same domain in IE 8 and IE 9.", T[8] = "File is corrupted.", T[9] = "Error during file loading.", T[R] = "File upload cancelled"; var i, ie, ne, ae, re, se, n, oe, le, de, fe = ""; function ce(e) { fe = e, i = document.getElementsByClassName(e), Array.prototype.map.call(i, function (e) { !function t(e) { e.addEventListener("dragover", function (e) { e.preventDefault(), ie = e.pageX, ne = e.pageY; var t = document.getElementById("filesList"); ne + 20 > t.getBoundingClientRect().bottom && pe(t, 0, 10), ne - 20 < t.getBoundingClientRect().top && pe(t, 0, -10) }, !1), e.ondrag = ge, e.ondragend = ue, k.helpers.isMobile() && (k.events.on("window.touchmove touchmove", ge), e.addEventListener("touchend", ue)) }(e) }) } function pe(e, t, i) { e.scrollLeft += t, e.scrollTop += i } function ge(e) { for (k.helpers.isMobile() && (re = event.touches[0].clientX, se = event.touches[0].clientY), ae = e.target; !ae.classList.contains(fe);)ae = ae.parentElement; ae.classList.contains(fe) && !ae.classList.contains("fr-unchecked") ? ae.classList.add("drag-sort-active") : ae = undefined } function ue(e) { if (ae !== undefined) { var t, i; i = k.helpers.isMobile() ? (t = re, se) : (t = event.clientX, event.clientY), (!k.helpers.isMobile() && k.browser.safari || k.browser.mozilla) && (t = ie, i = ne); for (var n = document.elementFromPoint(t, i); n && !n.classList.contains(fe);)n = n.parentElement; n && !n.classList.contains(fe) ? n = undefined : n && ae !== n && function o(e, t) { var i, n, a = e.parentNode, r = t.parentNode; if (!a || !r || a.isEqualNode(t) || r.isEqualNode(e)) return; for (var s = 0; s < a.children.length; s++)a.children[s].isEqualNode(e) && (i = s); for (var s = 0; s < r.children.length; s++)r.children[s].isEqualNode(t) && (n = s); a.isEqualNode(r) && i < n && n++; a.insertBefore(t, a.children[i]), r.insertBefore(e, r.children[n]) }(ae, n), e.target.classList.remove("drag-sort-active") } } function me(e) { var n = k.popups.get("filesManager.insert"); n.find(".fr-upload-progress-layer").hasClass("fr-active") || n.find(".fr-upload-progress-layer").addClass("fr-active"), n.find(".fr-upload-progress").removeClass("fr-none"); var t = L.get(e), i = function s(e) { var t, i = { weekday: "long", year: "numeric", month: "long", day: "numeric" }; try { t = e.toLocaleDateString(k.opts.language ? k.opts.language : undefined, i) } catch (n) { t = e.toLocaleDateString(undefined, i) } return t + ", " }(new Date), a = D.get(e) ? "" : "fr-unchecked ", r = "\n        <div id='fr-file-".concat(e, "' class='fr-file-list-item fr-file-").concat(e, " ").concat(a, "' draggable = \"").concat(!a, '" >\n        <div class=\'fr-file-item-left\' >\n    \n            <div class="fr-file-item-insert-checkbox fr-files-checkbox-line">\n            <div id="checkbox-key-').concat(e, '" class="fr-files-checkbox fr-insert-checkbox  fr-checkbox-').concat(e, '">\n            <input name="target" class="fr-insert-attr fr-checkbox-file-').concat(e, ' fr-file-insert-check" data-cmd="fileInsertCheckbox"\n             data-checked="_blank" type="checkbox" id="fr-link-target-').concat(k.id, '" tabIndex="0" />\n            <span>').concat('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z" fill="#FFF"></path></svg>', '\n            </span>\n        </div>\n                <label id="fr-label-target-').concat(k.id, "\"></label>\n            </div>\n    \n            <div class='fr-file-item-icon fr-file-item-icon-").concat(e, "' >\n                <img src='https://secure.webtoolhub.com/static/resources/icons/set112/f2afb6f7.png' alt='Image preview' class='thumbnail-padding' height='36px' width='36px' />\n            </div>\n\n            <div class='fr-file-item-description' >\n                <div class='fr-file-name tooltip'>\n                   ").concat(ve(t.name, 20), '\n                      <span class="').concat(20 < t.name.length ? "tooltiptext" : "fr-none", '">').concat(t.name, "\n                      </span>\n                 </div>\n                 <div class='fr-file-details'>\n                 <div class='fr-file-date tooltip'>").concat(ve(i, 50), '\n                     <span class="').concat(50 < i.length ? "tooltiptext" : "fr-none", '">').concat(i, "\n                     </span>\n                 </div>\n \n                 <div class='fr-file-size'>\n                     ").concat(function o(e) { if (0 == e) return "0 Bytes"; var t = Math.floor(Math.log(e) / Math.log(1024)); return 1 * (e / Math.pow(1024, t)).toFixed(2) + " " + ["Bytes", "KB", "MB", "GB", "TB"][t] }(t.size), "\n                 </div>\n                 </div>\n\n                  <div class='fr-file-error'>\n                    <h5 class='fr-file-error-h5'></h5>\n                 </div>\n             </div>\n    \n        </div>\n\n        <div class='fr-file-item-right fr-file-item-right-").concat(e, "'>") + ye(e) + "</div>\n    </div>"; n.find(".fr-upload-progress-layer")[0].innerHTML = r + n.find(".fr-upload-progress-layer")[0].innerHTML, L.forEach(function l(e, t, i) { D.get(t) && n.find("input.fr-insert-attr.fr-checkbox-file-".concat(t))[0].setAttribute("checked", null) }), S.forEach(function (e) { document.getElementById("fr-file-autoplay-button-" + e).checked = !0 }), be(e, t), Q(), k.opts.toolbarBottom ? U(!0) : k.popups.setPopupDimensions(n), ce("fr-file-list-item") } function ve(e, t, i) { return null == t && (t = 100), null == i && (i = "..."), e.length > t ? e.substring(0, t - i.length) + i : e } function he(e) { switch (e) { case "application/msword": return k.icon.getFileIcon("docIcon"); case "application/vnd.openxmlformats-officedocument.wordprocessingml.document": return k.icon.getFileIcon("docxIcon"); case "image/gif": return k.icon.getFileIcon("gifIcon"); case "image/jpeg": return k.icon.getFileIcon("jpegIcon"); case "image/jpeg": return k.icon.getFileIcon("jpgIcon"); case "type/text": return k.icon.getFileIcon("logIcon"); case "video/quicktime": return k.icon.getFileIcon("movIcon"); case "audio/mp3": case "audio/mpeg": return k.icon.getFileIcon("mp3Icon"); case "video/mp4": return k.icon.getFileIcon("mp4Icon"); case "audio/ogg": return k.icon.getFileIcon("oggIcon"); case "video/ogg": return k.icon.getFileIcon("ogvIcon"); case "application/pdf": return k.icon.getFileIcon("pdfIcon"); case "image/png": return k.icon.getFileIcon("pngIcon"); case "text/plain": return k.icon.getFileIcon("txtIcon"); case "video/webm": return k.icon.getFileIcon("webmIcon"); case "image/webp": return k.icon.getFileIcon("webpIcon"); case "video/x-ms-wmv": return k.icon.getFileIcon("wmvIcon"); case "application/vnd.ms-excel": return k.icon.getFileIcon("xlsIcon"); case "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet": return k.icon.getFileIcon("xlsxIcon"); case "application/x-zip-compressed": case "application/zip": return k.icon.getFileIcon("zipIcon"); default: return k.icon.getFileIcon("defaultIcon") } } function be(n, a, e) { var r = k.popups.get("filesManager.insert"), t = r.find(".fr-file-item-icon-" + n).get(0); if ($e(Le(a)) && "image/gif" != Le(a) && "image/webp" != Le(a)) { "a" != t.children[0].localName && (t.innerHTML = "<a target='_blank' href=''>" + t.innerHTML + "</a>"); r.find(".fr-file-item-icon-" + n).get(0).children[0].children[0]; var s = new FileReader; if (null != e && e) { var i = L.get(n); a.name = i.name, L.set(n, a) } if (s.onloadend = function () { r.find(".fr-file-item-icon-" + n).get(0).children[0].children[0].src = s.result; for (var e = atob(s.result.split(",")[1]), t = [], i = 0; i < e.length; i++)t.push(e.charCodeAt(i)); r.find(".fr-file-item-icon-" + n).get(0).children[0].href = window.URL.createObjectURL(new Blob([new Uint8Array(t)], { type: Le(a) })), r.find(".fr-file-item-icon-" + n).get(0).classList.add("file-item-thumbnail-hover") }, a) s.readAsDataURL(a); else { var o = he(Le(a)); t.innerHTML = '<svg height="40px" width="40px" viewBox="0 0 55 5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        '.concat(o.path, "\n        </svg>") } } else { var l = he(Le(a)); t.innerHTML = '<svg height="40px" width="40px" viewBox="0 0 55 55" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      '.concat(l.path, "\n      </svg>") } } function ye(e) { var t = ""; if (ze(Le(L.get(e)))) { var i = "fr-files-checkbox", n = ""; Ne(Le(L.get(e))) || (i = "fr-checkbox-disabled", n = "disabled"); t = '\n      <div class="fr-files-checkbox-line align-autoplay">\n      <div id="checkbox-key-'.concat(e, '" class="').concat(i, " fr-autoplay-checkbox  fr-checkbox-").concat(e, '">  \n                   \n      <input type="checkbox" id="fr-file-autoplay-button-').concat(e, '" class="fr-file-button-').concat(e, ' fr-file-autoplay-button" data-title="Edit" data-param1="').concat(e, '" role="button" ').concat(n, "/>\n\n      <span>").concat('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z" fill="#FFF"></path></svg>', " </span>\n      </div>      \n      <label  class='fr-autoplay-checkbox-label'>Autoplay </label>\n      </div>") } var a = "application/msword", r = "application/vnd.openxmlformats-officedocument.wordprocessingml.document", s = "", o = ""; return !Pe(Le(L.get(e))) && Ne(Le(L.get(e))) || (s = "fr-disabled"), ze(Le(L.get(e))) && (s = "fr-disabled"), Ue(Le(L.get(e))) && (s = "fr-disabled", Le(L.get(e)) != a && Le(L.get(e)) != r || k.opts.googleOptions && !k.helpers.isMobile() && k.opts.googleOptions.API_KEY && k.opts.googleOptions.CLIENT_ID && (s = ""), "text/plain" != Le(L.get(e)) && Le(L.get(e)) != a && "application/pdf" != Le(L.get(e)) && Le(L.get(e)) != r && "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" != Le(L.get(e)) && "application/vnd.ms-excel" != Le(L.get(e)) && "type/text" != Le(L.get(e)) || (o = "")), "video/url" === Le(L.get(e)) && (s = "fr-disabled"), t += '<div class=\'fr-file-item-action-buttons\' >\n                <button type="button" id="fr-file-insert-button-'.concat(e, '" class=" fr-doc-edit-').concat(e, " fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \n                fr-file-button-").concat(e, " fr-file-insert-button-").concat(e, ' fr-file-insert-button" data-cmd="imageInsertByUpload" data-title="Insert" data-param1="').concat(e, '" tabIndex="2" role="button">\n                <svg style=\'margin:0px !important; opacity:0.9\' class = "fr-svg" focusable="false" width="16px" height="16px" viewBox = "-5 0 28 28" xlmns = "http://w3.org/200/svg"><path d = \'M 9.25 12 L 6.75 12 C 6.335938 12 6 11.664062 6 11.25 L 6 6 L 3.257812 6 C 2.703125 6 2.425781 5.328125 2.820312 4.933594 L 7.570312 0.179688 C 7.804688 -0.0546875 8.191406 -0.0546875 8.425781 0.179688 L 13.179688 4.933594 C 13.574219 5.328125 13.296875 6 12.742188 6 L 10 6 L 10 11.25 C 10 11.664062 9.664062 12 9.25 12 Z M 16 11.75 L 16 15.25 C 16 15.664062 15.664062 16 15.25 16 L 0.75 16 C 0.335938 16 0 15.664062 0 15.25 L 0 11.75 C 0 11.335938 0.335938 11 0.75 11 L 5 11 L 5 11.25 C 5 12.214844 5.785156 13 6.75 13 L 9.25 13 C 10.214844 13 11 12.214844 11 11.25 L 11 11 L 15.25 11 C 15.664062 11 16 11.335938 16 11.75 Z M 12.125 14.5 C 12.125 14.15625 11.84375 13.875 11.5 13.875 C 11.15625 13.875 10.875 14.15625 10.875 14.5 C 10.875 14.84375 11.15625 15.125 11.5 15.125 C 11.84375 15.125 12.125 14.84375 12.125 14.5 Z M 14.125 14.5 C 14.125 14.15625 13.84375 13.875 13.5 13.875 C 13.15625 13.875 12.875 14.15625 12.875 14.5 C 12.875 14.84375 13.15625 15.125 13.5 15.125 C 13.84375 15.125 14.125 14.84375 14.125 14.5 Z M 14.125 14.5 \'></path></svg>\n                </button>\n\n                <button type="button" id="fr-file-edit-button-').concat(e, '" class=" fr-doc-edit-').concat(e, " ").concat(s, " fr-img-icon fr-btn fr-command fr-submit \n                fr-file-action-icons fr-file-edit-button-").concat(e, " fr-file-button-").concat(e, ' fr-file-edit-button" data-cmd="editImage" data-title="Edit" data-param1="').concat(e, '" role="button">\n                <svg style=\'margin:0px !important; opacity:0.9\' class = "fr-svg" focusable="false" width="16px" height="16px" viewBox = "0 4 25 25" xlmns = "http://w3.org/200/svg"><path d = \'M17,11.2L12.8,7L5,14.8V19h4.2L17,11.2z M7,16.8v-1.5l5.6-5.6l1.4,1.5l-5.6,5.6H7z M13.5,6.3l0.7-0.7c0.8-0.8,2.1-0.8,2.8,0  c0,0,0,0,0,0L18.4,7c0.8,0.8,0.8,2,0,2.8l-0.7,0.7L13.5,6.3z\'></path></svg>\n                </button>\n                \n                <span class="fr-file-view-').concat(e, '"><button type="button" id="fr-file-view-button-').concat(e, '" class=" fr-doc-edit-').concat(e, " ").concat(o, " fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \n                fr-file-view-button-").concat(e, ' fr-file-view-button" data-cmd="viewImage" data-title="View" data-param1="').concat(e, '" tabIndex="2" role="button">\n                <svg style=\'margin:0px !important; opacity:0.9\' class = "fr-svg" focusable="false" width="16px" height="16px" viewBox = "15 19 21 21" xlmns = "http://w3.org/200/svg"> <path style="fill:none;stroke-width:0.9077;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 19.086094 16.541466 C 16.185625 16.541466 14.318281 19.447115 14.318281 19.447115 L 14.318281 19.555288 C 14.318281 19.555288 16.176719 22.475962 19.077187 22.475962 C 21.977656 22.475962 23.847969 19.576322 23.847969 19.576322 L 23.847969 19.465144 C 23.847969 19.465144 21.989531 16.541466 19.086094 16.541466 Z M 19.07125 21.024639 C 18.248906 21.024639 17.583906 20.357572 17.583906 19.53726 C 17.583906 18.716947 18.248906 18.04988 19.07125 18.04988 C 19.890625 18.04988 20.555625 18.716947 20.555625 19.53726 C 20.555625 20.357572 19.890625 21.024639 19.07125 21.024639 Z M 19.07125 21.024639 " transform="matrix(1.315789,0,0,1.3,0,0)"/></svg></button></span>\n\n                <button type="button" id="fr-file-delete-button-').concat(e, '" class=" fr-doc-edit-').concat(e, " fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons\n                fr-file-button-").concat(e, ' fr-file-delete-button" data-cmd="deleteImage" data-title="Delete" data-param1="').concat(e, '" role="button">\n                <svg style=\'margin:0px !important; opacity:0.9\' class = "fr-svg" focusable="false" width="16px" height="16px" viewBox = "-2 3 30 30" xlmns = "http://w3.org/200/svg"><path d = \'M15,10v8H9v-8H15 M14,4H9.9l-1,1H6v2h12V5h-3L14,4z M17,8H7v10c0,1.1,0.9,2,2,2h6c1.1,0,2-0.9,2-2V8z\'></path></svg>\n                </button>\n                 \n            </div>\n            <div id="user_area-').concat(e, "\" style=\"display: none;\">\n            \n              <div id=\"file_container\"></div>\n\n              <div style='display:block;text-align: center; margin-left:50%; id='edit-file-loader' class='fr-file-loader'></div>\n\n          </div> \n            ") } function we(e, t, i) { var n = k.popups.get("filesManager.insert"); if (!i && e <= 100) { n.find(".fr-checkbox-file-" + t).get(0).disabled = !0, n.find(".fr-checkbox-" + t).get(0).classList.remove("fr-files-checkbox"), n.find(".fr-checkbox-" + t).get(0).classList.add("fr-checkbox-disabled"); var a = n.find(".fr-file-progress-circle-" + t), r = n.find(".fr-file-upload-percent-" + t); return 50 < e ? a.get(0).setAttribute("class", "fr-file-progress-circle-" + t + " progress-circle p" + Math.floor(e) + " over50") : a.get(0).setAttribute("class", "fr-file-progress-circle-" + t + " progress-circle p" + Math.floor(e)), r.get(0).innerHTML = Math.floor(e) + "%", void xe(t, e, i) } i && (n.find(".fr-checkbox-file-" + t).get(0).disabled = !1, n.find(".fr-checkbox-" + t).get(0).classList.remove("fr-checkbox-disabled"), n.find(".fr-checkbox-" + t).get(0).classList.add("fr-files-checkbox"), n.find(".fr-file-item-right-" + t).get(0).innerHTML = ye(t), xe(t, 100, i)) } function xe(e, t, i) { var n = k.popups.get("filesManager.insert"); n.find(".fr-progress-bar").removeClass("fr-none").addClass("fr-display-block"), n.find(".fr-upload-progress").hasClass("fr-height-set") && k.popups.setFileListHeight(n); var a = 0; u.set(e, t), u.forEach(function (e, t) { a += e }), a /= u.size, 100 == t && i && r++, n.find('.fr-command[data-cmd="filesUpload"]').addClass("fr-disabled"), n.find('.fr-command[data-cmd="filesByURL"]').addClass("fr-disabled"), n.find('.fr-command[data-cmd="filesEmbed"]').addClass("fr-disabled"), n.find(".fr-progress-bar").get(0).style.width = a + "%", r == u.size && (n.find(".fr-progress-bar").removeClass("fr-display-block").addClass("fr-none"), u = new Map, r = 0, n.find('.fr-command[data-cmd="filesUpload"]').removeClass("fr-disabled"), n.find('.fr-command[data-cmd="filesByURL"]').removeClass("fr-disabled"), n.find('.fr-command[data-cmd="filesEmbed"]').removeClass("fr-disabled")) } function Ee(i, n) { Q(), k.popups.get("filesManager.insert").find(".fr-upload-progress-layer").addClass("fr-active"), i.forEach(function (e, t) { $e(Le(e)) && k.opts.imageUploadRemoteUrls && k.opts.imageCORSProxy && k.opts.imageUpload ? Re(e, i, h, n[t]) : _.set(n[t], e) }) } function Me(e) { (function i(e) { if ("false" == A(this).parents("[contenteditable]").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable")) return !0; if (e && "touchend" == e.type && de) return !0; if (e && k.edit.isDisabled()) return e.stopPropagation(), e.preventDefault(), !1; for (var t = 0; t < _t.INSTANCES.length; t++)_t.INSTANCES[t] != k && _t.INSTANCES[t].events.trigger("image.hideResizer"); k.toolbar.disable(), e && (e.stopPropagation(), e.preventDefault()); k.helpers.isMobile() && (k.events.disableBlur(), k.$el.blur(), k.events.enableBlur()); k.opts.iframe && k.size.syncIframe(); h = A(this), N(), k.browser.msie ? (k.popups.areVisible() && k.events.disableBlur(), k.win.getSelection && (k.win.getSelection().removeAllRanges(), k.win.getSelection().addRange(k.doc.createRange()))) : k.selection.clear(); k.helpers.isIOS() && (k.events.disableBlur(), k.$el.blur()); k.button.bulkRefresh(), k.events.trigger("video.hideResizer") }).call(e.get(0)) } function Ce() { var e = A(this); e.removeClass("fr-uploading"), e.next().is("br") && e.next().remove(), (0 == a.length || 0 < a.length && a.length == v) && (o = e), "VIDEO" == e.get(0).tagName || "AUDIO" == e.get(0).tagName ? k.selection.setAfter(e.parent()) : k.selection.setAfter(e), k.undo.saveStep(), k.events.trigger("filesManager.loaded", [e]), Ie(a) } function ke() { var e, t = Array.prototype.slice.call(k.el.querySelectorAll("video, .fr-video > *")), i = []; for (e = 0; e < t.length; e++)i.push(t[e].getAttribute("src")), A(t[e]).toggleClass("fr-draggable", k.opts.videoMove), "" === t[e].getAttribute("class") && t[e].removeAttribute("class"), "" === t[e].getAttribute("style") && t[e].removeAttribute("style"); if (n) for (e = 0; e < n.length; e++)i.indexOf(n[e].getAttribute("src")) < 0 && k.events.trigger("video.removed", [A(n[e])]); n = t } function Ie(e) { if (null != e) { if (0 == e.length) return void (null != o && ("VIDEO" == o.get(0).tagName ? k.video._editVideo(o.parent()) : "IMG" == o.get(0).tagName ? k.image.edit(o) : o.trigger("click"), k.toolbar.disable())); _e(e.shift(), e) } } function Ae(e) { var t = !1; if (ze(Le(_.get(e)))) k.trimVideoPlugin.trimVideo(L.get(e), e, L), t = !0; else if ($e(Le(_.get(e)))) { var i = _.get(e).link, n = k.o_doc.createElement("img"); n.src = i, h = n, s = e, k.imageTUI.launch(k, !1, e), t = !0 } else if (Ue(Le(_.get(e)))) { var a = { apiKey: k.opts.googleOptions.API_KEY, clientId: k.opts.googleOptions.CLIENT_ID, authorizeButton: "authorize_button-".concat(e), signoutButton: "signout_button", userArea: "user_area-".concat(e), fileInput: "file_input", fileIndex: e, file: L.get(e), fileContainer: "file_container", loadingText: "File is being uploaded...", events: { onInvalidFile: function (e) { }, onError: function (e) { } } }; le = function f(p) { var r, e = ["https://www.googleapis.com/discovery/v1/apis/drive/v2/rest"], g = "id,title,mimeType,userPermission,editable,copyable,shared,fileSize", u = "-------314159265358979323846", m = "\r\n--" + u + "\r\n", v = "\r\n--" + u + "--", t = (document.getElementById(p.authorizeButton), document.getElementById(p.userArea)); p.events || (p.events = {}); function i() { gapi.client.init({ apiKey: p.apiKey, clientId: p.clientId, discoveryDocs: e, scope: "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata" }).then(function () { gapi.auth2.getAuthInstance().isSignedIn.listen(n), n(gapi.auth2.getAuthInstance().isSignedIn.get()), function t(e) { gapi.auth2.getAuthInstance().isSignedIn.get() ? s() : Promise.resolve(gapi.auth2.getAuthInstance().signIn()).then(function () { s() }) }() }, function (e) { p.events.onError(e) }) } function n(e) { e && (t.style.display = "block") } function a(e) { var t = gapi.auth.getToken().access_token, i = r, n = "https://docs.google.com/feeds/download/documents/export/Export?id=" + i + "&format=docx&access_token=" + t, a = new XMLHttpRequest; a.open("get", n), a.responseType = "arraybuffer", a.onload = function () { var e = new Blob([new Uint8Array(this.response)], { type: "application/vnd.openxmlformats-officedocument.wordprocessingml.document" }), t = L.get(p.fileIndex); e.name = t.name, e.lastModified = t.lastModified, e.lastModifiedDate = t.lastModifiedDate, L.set(p.fileIndex, e), k.filesManager.upload(e, _, h, p.fileIndex), l() }, a.send() } function s(e) { !function n(e) { for (var t = document.getElementsByClassName("fr-doc-edit-".concat(e)), i = 0; i < t.length; i++)t[i].setAttribute("disabled", !0), t[i].classList.add("fr-disabled") }(p.fileIndex); var t = p.file; t ? function i(d, f) { var c = new FileReader; c.readAsArrayBuffer(d), c.onload = function (e) { for (var t = { title: d.name, mimeType: "application/vnd.google-apps.document" }, i = "", n = new Uint8Array(c.result), a = n.byteLength, r = 0; r < a; r++)i += String.fromCharCode(n[r]); var s = btoa(i), o = m + "Content-Type: application/json; charset=UTF-8\r\n\r\n" + JSON.stringify(t) + m + "Content-Type: application/octet-stream\r\nContent-Transfer-Encoding: base64\r\n\r\n" + s + v, l = gapi.client.request({ path: "/upload/drive/v2/files", method: "POST", params: { uploadType: "multipart", fields: g }, headers: { "Content-Type": 'multipart/related; boundary="' + u + '"', "Content-Length": o.Length }, body: o }); f || (f = function (e) { }), l.execute(function (e, t) { e.error ? p.events.onError(e.error) : f(e) }) } }(t, o) : p.events.onInvalidFile("File is not selected") } function o(e) { r = e.id; var t = "https://docs.google.com/document/d/" + e.id + "/edit", i = k.o_doc.body, n = k.o_doc.createElement("div"); n.setAttribute("id", "editDocContainer"), n.style.cssText = "position: fixed; top: 0;left: 0;padding: 0;width: 100%;height: 100%;background: rgba(255,255,255,1);z-index: 9998;display:block", n.innerHTML = '<div style="margin-top:25px; text-align:center"><label>Sign Out : </label><input type="checkbox" id ="markSignOut" role="button"/>  <button id="signout_button"  class="fr-trim-button" >Save </button> <button id="cancel_file_edit" class="fr-trim-button">Cancel</button></div>  <iframe title="Edit your file" frameBorder="0" width="100%" height="700px" src="' + t + '"></iframe>', i.appendChild(n), document.getElementById("signout_button").onclick = a, document.getElementById("cancel_file_edit").onclick = l } function l() { document.getElementById("markSignOut").checked && gapi.auth2.getAuthInstance().signOut(); var e = document.getElementById("editDocContainer"); e.parentNode.removeChild(e), document.getElementById("user_area-".concat(p.fileIndex)) && (document.getElementById("user_area-".concat(p.fileIndex)).style.display = "none"), function n(e) { for (var t = document.getElementsByClassName("fr-doc-edit-".concat(e)), i = 0; i < t.length; i++)t[i].removeAttribute("disabled"), t[i].classList.remove("fr-disabled") }(p.fileIndex) } p.events.onInvalidFile = p.events.onInvalidFile || function (e) { }, p.events.onError = p.events.onError || function (e) { }; var d = {}; return d.handleClientLoad = function () { gapi.load("client:auth2", i) }, d }(a), function r(e, t) { var n = function n(e, t) { var i = document.createElement("script"); i.src = e, i.onload = function () { this.onload = function () { }, le.handleClientLoad() }, i.onreadystatechange = function () { "complete" === this.readyState && this.onload() }, (document.getElementsByTagName("head")[0] || document.body).appendChild(i) }; !function i() { 0 != e.length ? n(e.shift(), i) : t && t() }() }(["https://apis.google.com/js/api.js"], function () { }) } t && (c = !0) } function Le(e) { if ("" != e.type) return e.type; var i, n = /(?:\.([^.]+))?$/.exec(e.name)[1]; return [[".doc", "application/msword"], [".docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document"], [".gif", "image/gif"], [".jpeg", "image/jpeg"], [".jpg", "image/jpeg"], [".txt", "text/plain"], [".log", "type/text"], [".mov", "video/quicktime"], [".mp3", "audio/mpeg"], [".mp4", "video/mp4"], [".ogg", "audio/ogg"], [".ogv", "video/ogg"], [".pdf", "application/pdf"], [".png", "image/png"], [".webm", "video/webm"], [".webp", "image/webp"], [".wmv", "video/x-ms-wmv"], [".xls", "application/vnd.ms-excel"], [".xlsx", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"], [".zip", "application/x-zip-compressed"]].forEach(function (e, t) { e[0] == ".".concat(n) && (i = e[1]) }), i } function _e(o, e) { if (Ue(Le(_.get(o))) || !Ne(Le(_.get(o)))) { var t = _.get(o).link, i = _.get(o).text; !i && L.get(o) && L.get(o).name && (i = L.get(o).name); var n = _.get(o).response; if (k.edit.on(), k.events.focus(!0), k.selection.restore(), k.opts.fileUseSelectedText && k.selection.text().length && (i = k.selection.text()), t.endsWith(".pdf") || t.endsWith(".txt")) De('<iframe src="'.concat(t, '" title="').concat(i, '" width="\u201d100%\u201d" height="\u201d100%\u201d" class="fr-file"></iframe>'), !0); else k.html.insert('<a href="'.concat(t, '" target="_blank" id="fr-inserted-file" class="fr-file">').concat(i, "</a>")); var a = k.$el.find("#fr-inserted-file"); a.removeAttr("id"), k.undo.saveStep(), function E() { var e, t = Array.prototype.slice.call(k.el.querySelectorAll("a.fr-file")), i = []; for (e = 0; e < t.length; e++)i.push(t[e].getAttribute("href")); if (oe) for (e = 0; e < oe.length; e++)i.indexOf(oe[e].getAttribute("href")) < 0 && k.events.trigger("file.unlink", [oe[e]]); oe = t }(), k.selection.clear(), k.selection.setAfter(a), k.events.trigger("file.inserted", [a, n]), Ie(e) } if ($e(Le(_.get(o))) && Ne(Le(_.get(o)))) { var s = _.get(o).link, r = _.get(o).sanitize, l = _.get(o).data, d = _.get(o).$existing_img, f = _.get(o).response; d && "string" == typeof d && (d = k.$(d)), k.edit.off(), J(k.language.translate("Loading image")), r && (s = k.helpers.sanitizeURL(s)); var c = new Image; c.onload = function () { var e, t; if (d) { k.undo.canDo() || d.hasClass("fr-uploading") || k.undo.saveStep(); var i = d.data("fr-old-src"); d.data("fr-image-pasted") && (i = null), k.$wp ? ((e = d.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted")).off("load"), i && d.attr("src", i), d.replaceWith(e)) : e = d; for (var n = e.get(0).attributes, a = 0; a < n.length; a++) { var r = n[a]; 0 === r.nodeName.indexOf("data-") && e.removeAttr(r.nodeName) } if (void 0 !== l) for (t in l) l.hasOwnProperty(t) && "link" != t && e.attr("data-".concat(t), l[t]); e.on("load", Ce), e.attr("src", s), k.edit.on(), k.undo.saveStep(), k.events.disableBlur(), k.$el.blur(), k.events.trigger(i ? "image.replaced" : "image.inserted", [e, f]) } else e = function o(e, t, i) { var n, a = A(document.createElement("img")).attr("src", e); if (t && void 0 !== t) for (n in t) t.hasOwnProperty(n) && "link" != n && (" data-".concat(n, '="').concat(t[n], '"'), a.attr("data-".concat(n), t[n])); var r = k.opts.imageDefaultWidth; r && "auto" != r && (r = k.opts.imageResizeWithPercent ? "100%" : "".concat(r, "px")); a.attr("style", r ? "width: ".concat(r, ";") : ""), lt(a, k.opts.imageDefaultDisplay, k.opts.imageDefaultAlign), a.on("load", i), a.on("error", i), k.edit.on(), k.events.focus(!0), k.selection.restore(), k.undo.saveStep(), k.opts.imageSplitHTML ? k.markers.split() : k.markers.insert(); k.html.wrap(); var s = k.$el.find(".fr-marker"); s.length ? (s.parent().is("hr") && s.parent().after(s), k.node.isLastSibling(s) && s.parent().hasClass("fr-deletable") && s.insertAfter(s.parent()), s.replaceWith(a)) : k.$el.append(a); return a }(s, l, Ce), k.undo.saveStep(), k.events.disableBlur(), k.$el.blur(), k.events.trigger("image.inserted", [e, f]) }, c.onerror = function () { G(B, null, null, o), Ie(e) }, c.src = s } if ((ze(Le(_.get(o))) || Pe(Le(_.get(o)))) && Ne(Le(_.get(o)))) if (I = o, "video/url" == Le(_.get(o))) { var p = !1; if (document.getElementById("fr-file-autoplay-button-" + o) !== undefined && (p = document.getElementById("fr-file-autoplay-button-" + o).checked), p && _.get(o) !== undefined && -1 < _.get(o).video.indexOf("iframe") && _.get(o).video.indexOf("autoplay=1") < 0) { var g = _.get(o).video.substring(_.get(o).video.indexOf("src") + 3), u = "&"; (g = (g = g.substring(g.indexOf('"') + 1)).substring(0, g.indexOf('"'))).indexOf("?") < 0 && (u = "?"), _.get(o).video = _.get(o).video.replace(g, g += u + "autoplay=1") } else !p && _.get(o).video.indexOf(!1) && (-1 < _.get(o).video.indexOf("&autoplay=1") && (_.get(o).video = _.get(o).video.replace("&autoplay=1", "")), -1 < _.get(o).video.indexOf("?autoplay=1") && (_.get(o).video = _.get(o).video.replace("?autoplay=1", ""))); k.events.focus(!0), k.selection.restore(), k.html.insert('<span contenteditable="false" draggable="true" class="fr-jiv fr-video fr-deletable">'.concat(_.get(o).video, "</span>"), !1, k.opts.videoSplitHTML), k.popups.hide("filesManager.insert"); var m = k.$el.find(".fr-jiv"); m.removeClass("fr-jiv"), m.toggleClass("fr-rv", k.opts.videoResponsive), function M(e, t, i) { !k.opts.htmlUntouched && k.opts.useClasses ? (e.removeClass("fr-fvl fr-fvr fr-dvb fr-dvi"), e.addClass("fr-fv".concat(i[0], " fr-dv").concat(t[0]))) : "inline" == t ? (e.css({ display: "inline-block" }), "center" == i ? e.css({ "float": "none" }) : "left" == i ? e.css({ "float": "left" }) : e.css({ "float": "right" })) : (e.css({ display: "block", clear: "both" }), "left" == i ? e.css({ textAlign: "left" }) : "right" == i ? e.css({ textAlign: "right" }) : e.css({ textAlign: "center" })) }(m, k.opts.videoDefaultDisplay, k.opts.videoDefaultAlign), m.toggleClass("fr-draggable", k.opts.videoMove), k.events.trigger("video.inserted", [m]), Ce.call(m) } else { var v = _.get(o).link, h = _.get(o).sanitize, b = _.get(o).data, y = _.get(o).$existing_img, w = _.get(o).response; k.edit.off(), h && (v = k.helpers.sanitizeURL(v)), function C() { var e, t; if (y) { k.undo.canDo() || y.find("video").hasClass("fr-uploading") || k.undo.saveStep(); var i = y.find("video").data("fr-old-src"), n = y.data("fr-replaced"); y.data("fr-replaced", !1), k.$wp ? ((e = y.clone(!0)).find("video").removeData("fr-old-src").removeClass("fr-uploading"), e.find("video").off("canplay"), i && y.find("video").attr("src", i), y.replaceWith(e)) : e = y; for (var a = e.find("video").get(0).attributes, r = 0; r < a.length; r++) { var s = a[r]; 0 === s.nodeName.indexOf("data-") && e.find("video").removeAttr(s.nodeName) } if (void 0 !== b) for (t in b) b.hasOwnProperty(t) && "link" != t && e.find("video").attr("data-".concat(t), b[t]); e.find("video").on("canplay", Ce), e.find("video").attr("src", v), k.edit.on(), ke(), k.undo.saveStep(), k.$el.blur(), k.events.trigger(n ? "video.replaced" : "video.inserted", [e, w]) } else e = function g(e, t, i, n, a) { var r, s = ""; if (t && void 0 !== t) for (r in t) t.hasOwnProperty(r) && "link" != r && (s += " data-".concat(r, '="').concat(t[r], '"')); var o, l = k.opts.videoDefaultWidth; l && "auto" != l && (l = "".concat(l, "px")); if (Pe(n)) o = A(document.createElement("span")).attr("contenteditable", "false").attr("draggable", "true").attr("class", "fr-video fr-dv" + k.opts.videoDefaultDisplay[0] + ("center" != k.opts.videoDefaultAlign ? " fr-fv" + k.opts.videoDefaultAlign[0] : "")).html('<audio src="' + e + '" ' + s + " controls>" + k.language.translate("Your browser does not support HTML5 video.") + "</audio>"); else { var d = "", f = document.getElementById("fr-file-autoplay-button-" + a).checked; f && (d = "autoplay"), o = A(document.createElement("span")).attr("contenteditable", "false").attr("draggable", "true").attr("class", "fr-video fr-dv" + k.opts.videoDefaultDisplay[0] + ("center" != k.opts.videoDefaultAlign ? " fr-fv" + k.opts.videoDefaultAlign[0] : "")).html('<video src="' + e + '" ' + s + (l ? ' style="width: ' + l + ';" ' : "") + d + "  controls>" + k.language.translate("Your browser does not support HTML5 video.") + "</video>") } o.toggleClass("fr-draggable", k.opts.videoMove), k.edit.on(), k.events.focus(!0), k.selection.restore(), k.undo.saveStep(), k.opts.videoSplitHTML ? k.markers.split() : k.markers.insert(); k.html.wrap(); var c = k.$el.find(".fr-marker"); k.node.isLastSibling(c) && c.parent().hasClass("fr-deletable") && c.insertAfter(c.parent()); c.replaceWith(o); var p = ""; p = Pe(n) ? "audio" : "video", o.find(p).get(0).readyState > o.find(p).get(0).HAVE_FUTURE_DATA || k.helpers.isIOS() ? i.call(o.find(p).get(0)) : (o.find(p).on("canplaythrough load", i), o.find(p).on("error", i)); return o }(v, b, Ce, Le(_.get(o)), o), ke(), k.undo.saveStep(), k.events.trigger("video.inserted", [e, w]) }() } k.popups.hide("filesManager.insert"), D["delete"](o); var x = k.popups.get("filesManager.insert"); x.find("input.fr-insert-attr.fr-checkbox-file-".concat(o))[0].checked = !1, x.find(".fr-file-" + o).get(0).classList.add("fr-unchecked"), X(), document.getElementById("fr-file-autoplay-button-" + o) && (document.getElementById("fr-file-autoplay-button-" + o).checked = !1), S = S.filter(function (e) { return e != o }) } function De(e, t) { var i, n; _t.VIDEO_EMBED_REGEX.test(e) ? (i = "video", n = k.opts.videoSplitHTML) : _t.IMAGE_EMBED_REGEX.test(e) && (i = "image", n = k.opts.imageSplitHTML), k.events.focus(!0), k.selection.restore(); var a = !1; h && (qe(), a = !0), k.html.insert('<span id="fr-inserted-file" contenteditable="true" draggable="true" class="fr-'.concat(i, ' fr-jiv fr-deletable">').concat(e, "</span>"), !1, n), k.popups.hide("filesManager.insert"); var r = k.$el.find(".fr-jiv"); r.removeClass("fr-jiv"), "video" == i && (r.toggleClass("fr-rv", k.opts.videoResponsive), function s(e, t, i) { !k.opts.htmlUntouched && k.opts.useClasses ? (e.removeClass("fr-fvl fr-fvr fr-dvb fr-dvi"), e.addClass("fr-fv".concat(i[0], " fr-dv").concat(t[0]))) : "inline" == t ? (e.css({ display: "inline-block" }), "center" == i ? e.css({ "float": "none" }) : "left" == i ? e.css({ "float": "left" }) : e.css({ "float": "right" })) : (e.css({ display: "block", clear: "both" }), "left" == i ? e.css({ textAlign: "left" }) : "right" == i ? e.css({ textAlign: "right" }) : e.css({ textAlign: "center" })) }(r, k.opts.videoDefaultDisplay, k.opts.videoDefaultAlign), r.toggleClass("fr-draggable", k.opts.videoMove), k.events.trigger(a ? "video.replaced" : "video.inserted", [r])), "image" == i && (lt(r, k.opts.imageDefaultDisplay, k.opts.imageDefaultAlign), r.find("img").removeClass("fr-dii"), r.find("img").addClass("fr-dib"), r.toggleClass("fr-draggable", k.opts.imageMove), k.events.trigger(a ? "image.replaced" : "image.inserted", [r])), t && (o = r, k.selection.clear(), k.toolbar.disable(), k.video._editVideo(o)) } function Se(e, t) { try { if (!1 === k.events.trigger("filesManager.uploaded", [e], !0)) return k.edit.on(), !1; var i = JSON.parse(e); return i.link ? i : (G(w, e, null, t), !1) } catch (n) { return G(E, e, null, t), !1 } } function Be(e, t) { try { var i = A(e).find("Location").text(), n = A(e).find("Key").text(); return !1 === k.events.trigger("filesManager.uploadedToS3", [i, n, e], !0) ? (k.edit.on(), !1) : i } catch (a) { return G(E, e, null, t), !1 } } function Re(e, t, i, n) { if (-1 < O.indexOf(Le(e)) || !Le(e)) return G(C, null, null, n), !1; if (!1 === k.events.trigger("filesManager.beforeUpload", [t])) return !1; if ((null === k.opts.filesManagerUploadURL || k.opts.filesManagerUploadURL == p) && !k.opts.filesManagerUploadToS3) return function c(o, l, d) { var f = new FileReader; f.onload = function () { var e = f.result; if (f.result.indexOf("svg+xml") < 0) { for (var t = atob(f.result.split(",")[1]), i = [], n = 0; n < t.length; n++)i.push(t.charCodeAt(n)); if (e = window.URL.createObjectURL(new Blob([new Uint8Array(i)], { type: Le(l) })), $e(Le(l))) { var a = { link: e, sanitize: !1, data: null, $existing_img: d, response: null, type: Le(l) }; _.set(o, a) } if (Ue(Le(l))) { var r = { link: e, text: l.name, response: null, type: Le(l) }; _.set(o, r) } if (ze(Le(l)) || Pe(Le(l))) { var s = { link: e, sanitize: !1, data: null, $existing_img: d, type: Le(l) }; _.set(o, s) } } }, f.readAsDataURL(l) }(n, e), !1; if ($e(Le(e)) && (e.name || (e.name = (new Date).getTime() + "." + (Le(e) || "image/jpeg").replace(/image\//g, ""))), e.size > k.opts.filesManagerMaxSize) return G(M, null, null, n), !1; if (k.opts.filesManagerAllowedTypes.indexOf("*") < 0 && k.opts.filesManagerAllowedTypes.indexOf(Le(e)) < 0) return G(C, null, null, n), !1; var a; if (function l(e) { isNaN(e) || (k.popups.get("filesManager.insert").find(".fr-file-item-right-" + e).get(0).innerHTML = '<div class=\'fr-file-item-action-buttons\' >\n    <button type="button" id="fr-file-cancel-upload-button-'.concat(e, '" class="fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \n    fr-file-button-').concat(e, ' fr-file-cancel-upload-button" data-cmd="cancelUpload" data-title="Cancel" data-param1="').concat(e, '" role="button">\n    <svg style=\'margin:0px !important; opacity:0.9\' class = "fr-svg" focusable="false" width="16px" height="16px" viewBox = "-2 3 30 30" xlmns = "http://w3.org/200/svg"><path d = \'M13.4,12l5.6,5.6L17.6,19L12,13.4L6.4,19L5,17.6l5.6-5.6L5,6.4L6.4,5l5.6,5.6L17.6,5L19,6.4L13.4,12z\'></path></svg>\n    </button>\n\n    <button type="button" id="fr-upload-delete-button-').concat(e, '" class="fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \n    fr-file-button-').concat(e, ' fr-upload-delete-button" data-cmd="deleteUpload" data-title="Delete" data-param1="').concat(e, '" role="button">\n    <svg style=\'margin:0px !important; opacity:0.9\' class = "fr-svg" focusable="false" width="16px" height="16px" viewBox = "-2 3 30 30" xlmns = "http://w3.org/200/svg"><path d = \'M15,10v8H9v-8H15 M14,4H9.9l-1,1H6v2h12V5h-3L14,4z M17,8H7v10c0,1.1,0.9,2,2,2h6c1.1,0,2-0.9,2-2V8z\'></path></svg>\n    </button>\n\n    <div class=\'progress-circle p0 fr-file-progress-circle-').concat(e, "'>\n                  <span class='fr-file-upload-percent-").concat(e, " fr-file-upload-percent'>0%</span>\n                  <div class='left-half-clipper'>\n                    <div class='first50-bar'></div>\n                    <div class='value-bar'></div>\n                  </div>\n                </div>\n            </div>"), u.set(e, 0)) }(n), k.drag_support.formdata && (a = k.drag_support.formdata ? new FormData : null), a) { var r; if (!1 !== k.opts.filesManagerUploadToS3) for (r in a.append("key", k.opts.filesManagerUploadToS3.keyStart + (new Date).getTime() + "-" + (e.name || "untitled")), a.append("success_action_status", "201"), a.append("X-Requested-With", "xhr"), a.append("Content-Type", Le(e)), k.opts.filesManagerUploadToS3.params) k.opts.filesManagerUploadToS3.params.hasOwnProperty(r) && a.append(r, k.opts.filesManagerUploadToS3.params[r]); for (r in k.opts.filesManagerUploadParams) k.opts.filesManagerUploadParams.hasOwnProperty(r) && a.append(r, k.opts.filesManagerUploadParams[r]); a.append(k.opts.filesManagerUploadParam, e, e.name); var s = k.opts.filesManagerUploadURL; k.opts.filesManagerUploadToS3 && (s = k.opts.filesManagerUploadToS3.uploadURL ? k.opts.filesManagerUploadToS3.uploadURL : "https://".concat(k.opts.filesManagerUploadToS3.region, ".amazonaws.com/").concat(k.opts.filesManagerUploadToS3.bucket)); var o = k.core.getXHR(s, k.opts.filesManagerUploadMethod); o.onload = function () { Ue(Le(e)) ? function p(e, t, i) { var n = this.status, a = this.response, r = this.responseXML, s = this.responseText; try { if (k.opts.filesManagerUploadToS3) if (201 === n) { var o = Be(r, t); if (o) { var l = { link: o, text: e, response: a, type: i }; _.set(t, l) } } else G(E, a || r, null, t); else if (200 <= n && n < 300) { var d = Se(s, t); if (d) { var f = { link: d.link, text: e, response: a, type: i }; _.set(t, f) } } else G(x, a || s, null, t) } catch (c) { G(E, a || s, null, t) } }.call(o, e.name, n, Le(e)) : function g(e, t, i) { var n = this.status, a = this.response, r = this.responseXML, s = this.responseText; try { if (k.opts.filesManagerUploadToS3) if (201 == n) { var o = Be(r, t); if (o) { var l = { link: o, sanitize: !1, data: [], $existing_img: e, response: a || r, type: i }; _.set(t, l) } } else G(E, a || r, e, t); else if (200 <= n && n < 300) { var d = Se(s, t); if (d) { var f = { link: d.link, sanitize: !1, data: d, $existing_img: e, response: a || r, type: i }; _.set(t, f) } } else G(x, a || s, e, t) } catch (c) { G(E, a || s, e, t) } }.call(o, h, n, Le(e)), m.has(n) || we(100, n, !0) }, o.onerror = function () { G(E, this.response || this.responseText || this.responseXML, null, n) }, o.upload.onprogress = function (e) { !function i(e, t) { e.lengthComputable && we(e.loaded / e.total * 100 | 0, t, !1) }(e, n) }, o.onabort = function (e) { !function i(e, t) { G(R, t, h, e) }(n, e) }, o.send(a), g.set(n, o) } } function Oe(l) { k.events.$on(l, "click", ".fr-upload-progress-layer", function (e) { if (k.helpers.isMobile()) return e.stopPropagation(), !1 }, !0), k.events.$on(l, "dragover dragenter", ".fr-upload-progress-layer", function (e) { e.preventDefault(); for (var t = 0; t < e.originalEvent.dataTransfer.types.length; t++)"Files" == e.originalEvent.dataTransfer.types[t] && (e.originalEvent.dataTransfer.dropEffect = "none"); return !1 }, !0), k.events.$on(l, "dragleave dragend", ".fr-upload-progress-layer", function (e) { return e.preventDefault(), !1 }, !0), k.events.$on(l, "dragover dragenter", ".fr-files-upload-layer", function (e) { return A(this).addClass("fr-drop"), (k.browser.msie || k.browser.edge) && e.preventDefault(), !1 }, !0), k.events.$on(l, "dragleave dragend", ".fr-files-upload-layer", function (e) { return A(this).removeClass("fr-drop"), (k.browser.msie || k.browser.edge) && e.preventDefault(), !1 }, !0), k.events.$on(l, "click", ".fr-insert-checkbox", function (e) { if (this.classList.contains("fr-checkbox-disabled")) return this.children.target.disabled = !0, void (this.children.target.checked = !1); var t = parseInt(this.id.split("-").pop()); D.set(t, this.children.target.checked); for (var i = l.find('.fr-command[data-cmd="insertAll"]'), n = l.find('.fr-command[data-cmd="deleteAll"]'), a = l.find('input.fr-file-insert-check[type="checkbox"]'), r = a.length, s = !0, o = 0; o < r; o++)1 == a[o].checked && (s = !1); if (s ? i.addClass("fr-disabled") : i.removeClass("fr-disabled"), s ? n.addClass("fr-disabled") : n.removeClass("fr-disabled"), this.children.target.checked) l.find(".fr-file-" + this.id.split("-").pop()).get(0).setAttribute("draggable", "true"), l.find(".fr-file-" + this.id.split("-").pop()).get(0).classList.remove("fr-unchecked"); else { this.id.split("-").pop(); l.find(".fr-file-" + this.id.split("-").pop()).get(0).setAttribute("draggable", "false"), l.find(".fr-file-" + this.id.split("-").pop()).get(0).classList.add("fr-unchecked") } }), k.events.$on(l, "click", ".fr-file-insert-button", function (e) { this.classList.contains("fr-disabled") || _e(parseInt(this.id.split("-").pop())) }), k.events.$on(l, "click", ".fr-file-autoplay-button", function (e) { if (this.parentNode.classList.contains("fr-checkbox-disabled")) return this.disabled = !0, void (this.checked = !1); Te(parseInt(this.id.split("-").pop())) }), k.events.$on(l, "click", ".fr-file-edit-button", function (e) { var t = parseInt(this.id.split("-").pop()); l.find(".fr-file-edit-button-".concat(t)).hasClass("fr-disabled") || Ae(t) }), k.events.$on(l, "click", ".fr-file-view-button", function (e) { var t = parseInt(this.id.split("-").pop()); l.find(".fr-file-view-button-".concat(t)).hasClass("fr-disabled") || function h(e) { if (!Ne(Le(_.get(e)))) { var t = _.get(e).link, i = _.get(e).link; if (L.get(e) && L.get(e).name ? i = L.get(e).name : _.get(e).text && (i = _.get(e).text), 0 === t.indexOf("blob:") && k.browser.msie && window.navigator && window.navigator.msSaveBlob) window.navigator.msSaveBlob(L.get(e), i); else { var n = document.createElement("a"); n.href = t, n.download = i, n.click() } return !1 } var a = k.popups.get("filesManager.insert"); if (0 < a.find(".fr-file-view-image-" + e).length) a.find(".fr-file-view-image-" + e)[0].remove(); else { for (var r = a.find(".fr-file-view"), s = 0; s < r.length; s++)r.get(s).remove(); var o = a.find(".fr-file-view-" + e); if ($e(Le(_.get(e)))) { var l = '<div class="fr-file-view-modal">\n              <div class="fr-file-view-modal-content">\n              <div class="fr-file-view-close">&times;</div> \n                <img src="' + _.get(e).link + "\" class ='fr-file-view-image'/>\n                </div>\n              </div>"; o[0].innerHTML = l + o[0].innerHTML } else if (ze(Le(_.get(e)))) { var d; if (_.get(e).hasOwnProperty("video")) { var f = _.get(e).video.substring(_.get(e).video.indexOf("src") + 3), c = f.substring(f.indexOf('"') + 1); c = c.substring(0, c.indexOf('"')), d = '<div class="fr-file-view-modal">\n        <div class="fr-file-view-modal-content ">\n          <div class="fr-file-view-close">&times;</div> \n          <iframe width="640" height="360" src="'.concat(c + "&autoplay=1", '" frameborder="0" class = "fr-file-view-image"></iframe>\n        </div>\n      </div>') } else d = '<div class="fr-file-view-modal">\n          <div class="fr-file-view-modal-content ">\n            <div class="fr-file-view-close">&times;</div> \n            <video controls src="' + _.get(e).link + "\"  class ='fr-file-view-image' autoplay></video>\n          </div>\n        </div>"; o[0].innerHTML = d + o[0].innerHTML } else if (Pe(Le(_.get(e)))) { var p = '<div class="fr-file-view-modal">\n        <div class="fr-file-view-modal-content ">\n          <div  class="fr-file-view-close">&times;</div> \n          <audio controls="controls"  class =\'fr-file-view-image\' autoplay>\n\n          <source src="'.concat(_.get(e).link, '" type="').concat(Le(_.get(e)), '" />\n\n            Your browser does not support the audio element.\n          </audio>\n        </div>\n      </div>'); o[0].innerHTML = p + o[0].innerHTML } else if (Ue(Le(_.get(e)))) { var g = _.get(e).link, u = _.get(e).text; if (g.endsWith(".pdf") || g.endsWith(".txt")) { var m = '<div class="fr-file-view-modal">\t\n              <div class="fr-file-view-modal-content " >\t\n              <div class="fr-file-view-close">&times;</div> \t\n              <iframe src="'.concat(g, "\" style='background-color: white;' height='50%' width='50%' title=\"").concat(u, '" class="fr-file fr-file-view-image"></iframe>\t\n            </div>\t\n            </div>'); o[0].innerHTML = m + o[0].innerHTML } else if (0 === g.indexOf("blob:") && k.browser.msie && window.navigator && window.navigator.msSaveBlob) window.navigator.msSaveBlob(L.get(e), u); else { var v = document.createElement("a"); v.href = g, v.download = u, v.click() } } } }(t) }), k.events.$on(l, "click", ".fr-file-delete-button", function (e) { j(parseInt(this.id.split("-").pop())) }), k.events.$on(l, "click", ".fr-file-cancel-upload-button", function (e) { !function i(e) { var t = k.popups.get("filesManager.insert"); t.find(".fr-file-item-right-" + e).get(0).innerHTML = ye(e), g.get(e).abort(), xe(e, 100, !0), t.find(".fr-checkbox-file-" + e).get(0).disabled = !0 }(parseInt(this.id.split("-").pop())) }), k.events.$on(l, "click", ".fr-upload-delete-button", function (e) { !function t(e) { 0 != g.get(e).readyState && (g.get(e).abort(), xe(e, 100, !0), g["delete"](e)), j(e) }(parseInt(this.id.split("-").pop())) }), k.events.$on(l, "click", ".fr-file-view-close", function (e) { l.find(".fr-file-view-modal").get(0).outerHTML = "" }), k.events.$on(l, "click", ".fr-plugins-enable", function (e) { !function t() { y.forEach(function (e) { k.opts.pluginsEnabled.indexOf(e) < 0 && k.opts.pluginsEnabled.push(e) }) }(), function i(e) { for (var t in e) if (!k[t]) { if (_t.PLUGINS[t] && k.opts.pluginsEnabled.indexOf(t) < 0) continue; k[t] = new e[t](k), k[t]._init && k[t]._init() } }(_t.PLUGINS), k.popups.get("filesManager.insert").get(0).outerHTML = "", Fe(), U(!0) }), k.events.$on(l, "click", ".fr-plugins-cancel", function (e) { k.popups.hide("filesManager.insert") }), k.events.$on(l, "drop", ".fr-upload-progress", function (e) { e.preventDefault(), e.stopPropagation() }), k.events.$on(l, "drop", ".fr-files-upload-layer", function (e) { e.preventDefault(), e.stopPropagation(), A(this).removeClass("fr-drop"); var t = e.originalEvent.dataTransfer; if (t && t.files) { var i = l.data("instance") || k; i.events.disableBlur(); for (var n = [], a = 0; a < t.files.length; a++) { var r = b; L.set(r, t.files[a]), me(r), D.set(r, !1), n.push(r), b++ } for (var s = 0; s < n.length; s++)i.filesManager.upload(L.get(n[s]), t.files, h, n[s]); i.events.enableBlur() } }, !0), k.helpers.isIOS() && k.events.$on(l, "touchstart", '.fr-files-upload-layer input[type="file"]', function () { A(this).trigger("click") }, !0), k.events.$on(l, "change", '.fr-files-upload-layer input[type="file"]', function () { if (this.files) { var e = l.data("instance") || k; e.events.disableBlur(), l.find("input:focus").blur(), e.events.enableBlur(); var t = []; if ("undefined" != typeof this.files && 0 < this.files.length) { for (var i = 0; i < this.files.length; i++) { var n = b; L.set(n, this.files[i]), me(n), D.set(n, !1), ++b, t.push(n) } for (var a = 0; a < t.length; a++)e.filesManager.upload(L.get(t[a]), this.files, h, t[a]) } } A(this).val("") }, !0) } function Te(t) { document.getElementById("fr-file-autoplay-button-" + t).checked ? S.push(t) : S = S.filter(function (e) { return e != t }) } function $e(e) { return e && "image" === e.split("/")[0] } function Ue(e) { return e && "image" != e.split("/")[0] && e && "video" != e.split("/")[0] && e && "audio" != e.split("/")[0] } function ze(e) { return e && "video" === e.split("/")[0] } function Pe(e) { return e && "audio" === e.split("/")[0] } function Ne(e) { var t = "audio/ogg", i = "video/ogg"; if (e == t || e == i || "image/webp" == e || "video/webm" == e) { if (k.browser.msie || k.browser.edge || k.browser.safari) return !1; if (k.helpers.isMobile()) { if (e == t || e == i) return !1; if (!k.helpers.isAndroid() && !k.browser.chrome) return !1 } } return !0 } function Fe(e) { if (e) return k.popups.onRefresh("filesManager.insert", $), k.popups.onHide("filesManager.insert", P), !0; var t, i, n = ""; k.opts.imageUpload || -1 === k.opts.filesInsertButtons.indexOf("filesUpload") || k.opts.imageInsertButtons.splice(k.opts.filesInsertButtons.indexOf("filesUpload"), 1); var a = k.button.buildList(k.opts.filesInsertButtons), r = k.button.buildList(k.opts.filesInsertButtons2); "" !== a && (n = '<div class="fr-buttons fr-tabs">'.concat(a, '<span class="fr-align-right">').concat(r, "</span></div>")); var s = k.opts.filesInsertButtons.indexOf("filesUpload"), o = k.opts.filesInsertButtons.indexOf("filesByURL"), l = k.opts.filesInsertButtons.indexOf("filesEmbed"), d = ""; 0 <= s && (t = " fr-active", 0 <= o && o < s && (t = ""), d = '<div class="fr-files-upload-layer'.concat(t, ' fr-layer " id="fr-files-upload-layer-').concat(k.id, '"><div style="display:flex"><div class="fr-upload-section"><div class = \'fr-blue-decorator\'><div class = \'fr-cloud-icon\'><svg class = "fr-svg" focusable="false" width="26px" height="26px" viewBox = "0 0 24 24" xlmns = "http://w3.org/200/svg"><path d = \'M12 6.66667a4.87654 4.87654 0 0 1 4.77525 3.92342l0.29618 1.50268 1.52794 0.10578a2.57021 2.57021 0 0 1 -0.1827 5.13478H6.5a3.49774 3.49774 0 0 1 -0.3844 -6.97454l1.06682 -0.11341L7.678 9.29387A4.86024 4.86024 0 0 1 12 6.66667m0 -2A6.871 6.871 0 0 0 5.90417 8.37 5.49773 5.49773 0 0 0 6.5 19.33333H18.41667a4.57019 4.57019 0 0 0 0.32083 -9.13A6.86567 6.86567 0 0 0 12 4.66667Zm0.99976 7.2469h1.91406L11.99976 9 9.08618 11.91357h1.91358v3H11V16h2V14h-0.00024Z\'></path></svg></div>Drag & Drop One or More Files<br><div class="decorated"><span> OR </span></div> Click Browse Files </div> </div><div class="fr-form"><input type="file" accept="').concat(k.opts.filesManagerAllowedTypes.join(",").toLowerCase(), '" tabIndex="-1" aria - labelledby="fr-files-upload-layer-').concat(k.id, '"role="button" multiple></div> </div></div>')); var f = ""; 0 <= l && (t = " fr-active", (s < l && 0 <= s || o < l && 0 <= o) && (t = ""), f = '<div class="fr-files-embed-layer fr-layer'.concat(t, '" id="fr-files-embed-layer-').concat(k.id, '"><div class="fr-input-line padding-top-15"><textarea data-gramm_editor="false" style=\'height:60px\' id="fr-files-embed-layer-text').concat(k.id, '" type="text" placeholder="').concat(k.language.translate("Embedded Code"), '" tabIndex="1" aria-required="true" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="insertEmbed" tabIndex="2" role="button">').concat(k.language.translate("Insert"), "</button></div></div>")); var c = ""; 0 <= o && (t = " fr-active", 0 <= s && s < o && (t = ""), c = '<div class="fr-files-by-url-layer'.concat(t, ' fr-layer" id="fr-files-by-url-layer-').concat(k.id, '"><div class="fr-input-line fr-by-url-padding"><input id="fr-files-by-url-layer-text-').concat(k.id, '" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="filesInsertByURL" tabIndex="2" role="button">').concat(k.language.translate("Add"), "</button></div></div>")); var p = { buttons: n, upload_layer: d, by_url_layer: c, embed_layer: f, upload_progress_layer: "<div class = ' fr-margin-16 fr-upload-progress' id=\"fr-upload-progress-layer-".concat(k.id, "\" ><div  class='fr-progress-bar-style'><div class='fr-progress-bar fr-none'></div></div><div id='filesList' class = 'fr-upload-progress-layer fr-layer'></div></div>"), progress_bar: '<div class="fr-files-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="filesDismissError" tabIndex="2" role="button">OK</button></div></div>' }; return 1 <= k.opts.imageInsertButtons.length && (i = k.popups.create("filesManager.insert", p)), k.$wp && k.events.$on(k.$wp, "scroll", function () { h && k.popups.isVisible("filesManager.insert") && replace() }), Oe(i), k.popups.setPopupDimensions(i), i } function He(e) { var t = e.split("/").pop(); if (t.split(".").length < 2) { var i = new Date; return t + "-" + i.getDate() + "/" + (i.getMonth() + 1) + "/" + i.getFullYear() } return t } function Ke() { h && k.popups.get("image.alt").find("input").val(h.attr("alt") || "").trigger("change") } function Ve() { var e = k.popups.get("image.alt"); e || (e = We()), Q(), k.popups.refresh("image.alt"), k.popups.setContainer("image.alt", k.$sc); var t = ft(); ct() && (t = t.find(".fr-img-wrap")); var i = t.offset().left + t.outerWidth() / 2, n = t.offset().top + t.outerHeight(); k.popups.show("image.alt", i, n, t.outerHeight(), !0) } function We(e) { if (e) return k.popups.onRefresh("image.alt", Ke), !0; var t = { buttons: '<div class="fr-buttons fr-tabs">'.concat(k.button.buildList(k.opts.imageAltButtons), "</div>"), alt_layer: '<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'.concat(k.id, '"><div class="fr-input-line"><input id="fr-image-alt-layer-text-').concat(k.id, '" type="text" placeholder="').concat(k.language.translate("Alternative Text"), '" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">').concat(k.language.translate("Update"), "</button></div></div>") }, i = k.popups.create("image.alt", t); return k.$wp && k.events.$on(k.$wp, "scroll.image-alt", function () { h && k.popups.isVisible("image.alt") && Ve() }), i } function Ye() { var e = k.popups.get("image.size"); if (h) if (ct()) { var t = h.parent(); t.get(0).style.width || (t = h.parent().parent()), e.find('input[name="width"]').val(t.get(0).style.width).trigger("change"), e.find('input[name="height"]').val(t.get(0).style.height).trigger("change") } else e.find('input[name="width"]').val(h.get(0).style.width).trigger("change"), e.find('input[name="height"]').val(h.get(0).style.height).trigger("change") } function Ge() { var e = k.popups.get("image.size"); e || (e = Xe()), Q(), k.popups.refresh("image.size"), k.popups.setContainer("image.size", k.$sc); var t = ft(); ct() && (t = t.find(".fr-img-wrap")); var i = t.offset().left + t.outerWidth() / 2, n = t.offset().top + t.outerHeight(); k.popups.show("image.size", i, n, t.outerHeight(), !0) } function Xe(e) { if (e) return k.popups.onRefresh("image.size", Ye), !0; var t = { buttons: '<div class="fr-buttons fr-tabs">'.concat(k.button.buildList(k.opts.imageSizeButtons), "</div>"), size_layer: '<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'.concat(k.id, '"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-\'').concat(k.id, '" type="text" name="width" placeholder="').concat(k.language.translate("Width"), '" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height').concat(k.id, '" type="text" name="height" placeholder="').concat(k.language.translate("Height"), '" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">').concat(k.language.translate("Update"), "</button></div></div>") }, i = k.popups.create("image.size", t); return k.$wp && k.events.$on(k.$wp, "scroll.image-size", function () { h && k.popups.isVisible("image.size") && Ge() }), i } function je(e, t, i, n) { return e.pageX = t, K.call(this, e), e.pageX = e.pageX + i * Math.floor(Math.pow(1.1, n)), V.call(this, e), W.call(this, e), ++n } function qe(e) { (e = e || ft()) && !1 !== k.events.trigger("image.beforeRemove", [e]) && (k.popups.hideAll(), at(!0), k.undo.canDo() || k.undo.saveStep(), e.get(0) == k.el ? e.removeAttr("src") : (e.get(0).parentNode && "A" == e.get(0).parentNode.tagName ? (k.selection.setBefore(e.get(0).parentNode) || k.selection.setAfter(e.get(0).parentNode) || e.parent().after(_t.MARKERS), A(e.get(0).parentNode).remove()) : (k.selection.setBefore(e.get(0)) || k.selection.setAfter(e.get(0)) || e.after(_t.MARKERS), e.remove()), k.html.fillEmptyBlocks(), k.selection.restore()), k.undo.saveStep()) } function Ze(e) { var t = e.which; if (h && (t == _t.KEYCODE.BACKSPACE || t == _t.KEYCODE.DELETE)) return e.preventDefault(), e.stopPropagation(), qe(), !1; if (h && t == _t.KEYCODE.ESC) { var i = h; return at(!0), k.selection.setAfter(i.get(0)), k.selection.restore(), e.preventDefault(), !1 } if (!h || t != _t.KEYCODE.ARROW_LEFT && t != _t.KEYCODE.ARROW_RIGHT) return h && t === _t.KEYCODE.TAB ? (e.preventDefault(), e.stopPropagation(), at(!0), !1) : h && t != _t.KEYCODE.F10 && !k.keys.isBrowserAction(e) ? (e.preventDefault(), e.stopPropagation(), !1) : void 0; var n = h.get(0); return at(!0), t == _t.KEYCODE.ARROW_LEFT ? k.selection.setBefore(n) : k.selection.setAfter(n), k.selection.restore(), e.preventDefault(), !1 } function Qe(e) { if (e && "IMG" == e.tagName) { if (k.node.hasClass(e, "fr-uploading") || k.node.hasClass(e, "fr-error") ? e.parentNode.removeChild(e) : k.node.hasClass(e, "fr-draggable") && e.classList.remove("fr-draggable"), e.parentNode && e.parentNode.parentNode && k.node.hasClass(e.parentNode.parentNode, "fr-img-caption")) { var t = e.parentNode.parentNode; t.removeAttribute("contenteditable"), t.removeAttribute("draggable"), t.classList.remove("fr-draggable"); var i = e.nextSibling; i && i.removeAttribute("contenteditable") } } else if (e && e.nodeType == Node.ELEMENT_NODE) for (var n = e.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable"), a = 0; a < n.length; a++)Qe(n[a]) } function Je(e) { if (!1 === k.events.trigger("image.beforePasteUpload", [e])) return !1; h = A(e), N(), replace(), Z(), h.on("load", function () { var t = []; N(), A(k.popups.get("filesManager.insert").get(0)).find("div.fr-active.fr-error").length < 1 && Z(), A(this).data("events").find(function (e) { "load" === e[0] && t.push(e) }), t.length <= 1 && A(this).off("load") }); for (var t = A(e).attr("src").split(","), i = atob(t[1]), n = [], a = 0; a < i.length; a++)n.push(i.charCodeAt(a)); Re([new Blob([new Uint8Array(n)], { type: t[0].replace(/data\:/g, "").replace(/;base64/g, "") })], h) } function et() { k.opts.imagePaste ? k.$el.find("img[data-fr-image-pasted]").each(function (e, n) { if (k.opts.imagePasteProcess) { var t = k.opts.imageDefaultWidth; t && "auto" != t && (t += k.opts.imageResizeWithPercent ? "%" : "px"), A(n).css("width", t).removeClass("fr-dii fr-dib fr-fir fr-fil"), lt(A(n), k.opts.imageDefaultDisplay, k.opts.imageDefaultAlign) } if (0 === n.src.indexOf("data:")) Je(n); else if (0 === n.src.indexOf("blob:") || 0 === n.src.indexOf("http") && k.opts.imageUploadRemoteUrls && k.opts.imageCORSProxy) { var i = new Image; i.crossOrigin = "Anonymous", i.onload = function () { var e, t = k.o_doc.createElement("CANVAS"), i = t.getContext("2d"); t.height = this.naturalHeight, t.width = this.naturalWidth, i.drawImage(this, 0, 0), setTimeout(function () { Je(n) }, 0), e = 2e3 < this.naturalWidth || 1500 < this.naturalHeight ? "jpeg" : "png", n.src = t.toDataURL("image/".concat(e)) }, i.src = (0 === n.src.indexOf("blob:") ? "" : "".concat(k.opts.imageCORSProxy, "/")) + n.src } else 0 !== n.src.indexOf("http") || 0 === n.src.indexOf("https://mail.google.com/mail") ? (k.selection.save(), A(n).remove(), k.selection.restore()) : A(n).removeAttr("data-fr-image-pasted") }) : k.$el.find("img[data-fr-image-pasted]").remove() } function tt(e) { var t = e.target.result, i = k.opts.imageDefaultWidth; i && "auto" != i && (i += k.opts.imageResizeWithPercent ? "%" : "px"), k.undo.saveStep(), k.html.insert('<img data-fr-image-pasted="true" src="'.concat(t, '"').concat(i ? ' style="width: '.concat(i, ';"') : "", ">")); var n = k.$el.find('img[data-fr-image-pasted="true"]'); n && lt(n, k.opts.imageDefaultDisplay, k.opts.imageDefaultAlign), k.events.trigger("paste.after") } function it(e) { if (e && e.clipboardData && e.clipboardData.items) { var t = null; if (e.clipboardData.types && -1 != [].indexOf.call(e.clipboardData.types, "text/rtf") || e.clipboardData.getData("text/rtf")) t = e.clipboardData.items[0].getAsFile(); else for (var i = 0; i < e.clipboardData.items.length && !(t = e.clipboardData.items[i].getAsFile()); i++); if (t) return function n(e) { var t = new FileReader; t.onload = tt, t.readAsDataURL(e) }(t), !1 } } function nt(e) { return e = e.replace(/<img /gi, '<img data-fr-image-pasted="true" ') } function at(e) { h && (function t() { return rt }() || !0 === e) && (k.toolbar.enable(), l && l.removeClass("fr-active"), k.popups.hide("image.edit"), h = null, ot(), d = null, f && f.hide()) } var rt = !1; function st() { rt = !0 } function ot() { rt = !1 } function lt(e, t, i) { !k.opts.htmlUntouched && k.opts.useClasses ? (e.removeClass("fr-fil fr-fir fr-dib fr-dii"), i && e.addClass("fr-fi".concat(i[0])), t && e.addClass("fr-di".concat(t[0]))) : "inline" == t ? (e.css({ display: "inline-block", verticalAlign: "bottom", margin: k.opts.imageDefaultMargin }), "center" == i ? e.css({ "float": "none", marginBottom: "", marginTop: "", maxWidth: "calc(100% - ".concat(2 * k.opts.imageDefaultMargin, "px)"), textAlign: "center" }) : "left" == i ? e.css({ "float": "left", marginLeft: 0, maxWidth: "calc(100% - ".concat(k.opts.imageDefaultMargin, "px)"), textAlign: "left" }) : e.css({ "float": "right", marginRight: 0, maxWidth: "calc(100% - ".concat(k.opts.imageDefaultMargin, "px)"), textAlign: "right" })) : "block" == t && (e.css({ display: "block", "float": "none", verticalAlign: "top", margin: "".concat(k.opts.imageDefaultMargin, "px auto"), textAlign: "center" }), "left" == i ? e.css({ marginLeft: 0, textAlign: "left" }) : "right" == i && e.css({ marginRight: 0, textAlign: "right" })) } function dt() { return h } function ft() { return ct() ? h.parents(".fr-img-caption").first() : h } function ct() { return !!h && 0 < h.parents(".fr-img-caption").length } return { _init: function pt() { var n; (function e() { k.events.$on(k.$el, k._mousedown, "IMG" == k.el.tagName ? null : 'img:not([contenteditable="false"])', function (e) { if ("false" == A(this).parents("contenteditable").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable")) return !0; k.helpers.isMobile() || k.selection.clear(), t = !0, k.popups.areVisible() && k.events.disableBlur(), k.browser.msie && (k.events.disableBlur(), k.$el.attr("contenteditable", !1)), k.draggable || "touchstart" == e.type || e.preventDefault(), e.stopPropagation() }), k.events.$on(k.$el, k._mousedown, ".fr-img-caption .fr-inner", function (e) { k.core.hasFocus() || k.events.focus(), e.stopPropagation() }), k.events.$on(k.$el, "paste", ".fr-img-caption .fr-inner", function (e) { k.toolbar.hide(), e.stopPropagation() }), k.events.$on(k.$el, k._mouseup, "IMG" == k.el.tagName ? null : 'img:not([contenteditable="false"])', function (e) { if ("false" == A(this).parents("contenteditable").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable")) return !0; t && (t = !1, e.stopPropagation(), k.browser.msie && (k.$el.attr("contenteditable", !0), k.events.enableBlur())) }), k.events.on("keyup", function (e) { if (e.shiftKey && "" === k.selection.text().replace(/\n/g, "") && k.keys.isArrow(e.which)) { var t = k.selection.element(), i = k.selection.endElement(); t && "IMG" == t.tagName ? Me(A(t)) : i && "IMG" == i.tagName && Me(A(i)) } }, !0), k.events.on("window.mousedown", st), k.events.on("window.touchmove", ot), k.events.on("mouseup window.mouseup", function () { if (h) return at(), !1; ot() }), k.events.on("commands.mousedown", function (e) { 0 < e.parents(".fr-toolbar").length && at() }), k.events.on("image.resizeEnd", function () { k.opts.iframe && k.size.syncIframe() }), k.events.on("blur image.hideResizer commands.undo commands.redo element.dropped", function () { at(!(t = !1)) }), k.events.on("modals.hide", function () { h && k.selection.clear() }), k.events.on("image.resizeEnd", function () { k.win.getSelection && Me(h) }), k.opts.imageAddNewLine && k.events.on("image.inserted", function (e) { var t = e.get(0); for (t.nextSibling && "BR" === t.nextSibling.tagName && (t = t.nextSibling); t && !k.node.isElement(t);)t = k.node.isLastSibling(t) ? t.parentNode : null; k.node.isElement(t) && (k.opts.enter === _t.ENTER_BR ? e.after("<br>") : A(k.node.blockParent(e.get(0))).after("<".concat(k.html.defaultTag(), "><br></").concat(k.html.defaultTag(), ">"))) }) })(), "IMG" == k.el.tagName && k.$el.addClass("fr-view"), k.helpers.isMobile() && (k.events.$on(k.$el, "touchstart", "IMG" == k.el.tagName ? null : 'img:not([contenteditable="false"])', function () { de = !1 }), k.events.$on(k.$el, "touchmove", function () { de = !0 })), k.$wp ? (k.events.on("window.keydown keydown", Ze, !0), k.events.on("keyup", function (e) { if (h && e.which == _t.KEYCODE.ENTER) return !1 }, !0), k.events.$on(k.$el, "keydown", function () { var e = k.selection.element(); (e.nodeType === Node.TEXT_NODE || "BR" == e.tagName && k.node.isLastSibling(e)) && (e = e.parentNode), k.node.hasClass(e, "fr-inner") || (k.node.hasClass(e, "fr-img-caption") || (e = A(e).parents(".fr-img-caption").get(0)), k.node.hasClass(e, "fr-img-caption") && (A(e).after(_t.INVISIBLE_SPACE + _t.MARKERS), k.selection.restore())) })) : k.events.$on(k.$win, "keydown", Ze), k.events.on("toolbar.esc", function () { if (h) { if (k.$wp) k.events.disableBlur(), k.events.focus(); else { var e = h; at(!0), k.selection.setAfter(e.get(0)), k.selection.restore() } return !1 } }, !0), k.events.on("toolbar.focusEditor", function () { if (h) return !1 }, !0), k.events.on("window.cut window.copy", function (e) { if (h && k.popups.isVisible("image.edit") && !k.popups.get("image.edit").find(":focus").length) { var t = ft(); ct() ? (t.before(_t.START_MARKER), t.after(_t.END_MARKER), k.selection.restore(), k.paste.saveCopiedText(t.get(0).outerHTML, t.text())) : k.paste.saveCopiedText(h.get(0).outerHTML, h.attr("alt")), "copy" == e.type ? setTimeout(function () { Me(h) }) : (at(!0), k.undo.saveStep(), setTimeout(function () { k.undo.saveStep() }, 0)) } }, !0), k.browser.msie && k.events.on("keydown", function (e) { if (!k.selection.isCollapsed() || !h) return !0; var t = e.which; t == _t.KEYCODE.C && k.keys.ctrlKey(e) ? k.events.trigger("window.copy") : t == _t.KEYCODE.X && k.keys.ctrlKey(e) && k.events.trigger("window.cut") }), k.events.$on(A(k.o_win), "keydown", function (e) { var t = e.which; if (h && t == _t.KEYCODE.BACKSPACE) return e.preventDefault(), !1 }), k.events.$on(k.$win, "keydown", function (e) { var t = e.which; h && h.hasClass("fr-uploading") && t == _t.KEYCODE.ESC && h.trigger("abortUpload") }), k.events.on("destroy", function () { h && h.hasClass("fr-uploading") && h.trigger("abortUpload") }), k.events.on("paste.before", it), k.events.on("paste.beforeCleanup", nt), k.events.on("paste.after", et), k.events.on("html.processGet", Qe), k.opts.imageOutputSize && k.events.on("html.beforeGet", function () { n = k.el.querySelectorAll("img"); for (var e = 0; e < n.length; e++) { var t = n[e].style.width || A(n[e]).width(), i = n[e].style.height || A(n[e]).height(); t && n[e].setAttribute("width", "".concat(t).replace(/px/, "")), i && n[e].setAttribute("height", "".concat(i).replace(/px/, "")) } }), k.opts.iframe && k.events.on("image.loaded", k.size.syncIframe), k.events.$on(A(k.o_win), "orientationchange.image", function () { setTimeout(function () { h && Me(h) }, 100) }), function a(e) { if (e) return k.$wp && k.events.$on(k.$wp, "scroll.image-edit", function () { h && k.popups.isVisible("image.edit") && k.events.disableBlur() }), !0; var t = ""; if (0 < k.opts.imageEditButtons.length) { var i = { buttons: t += '<div class="fr-buttons"> \n        '.concat(k.button.buildList(k.opts.imageEditButtons), "\n        </div>") }; return k.popups.create("image.edit", i) } return !1 }(!0), Fe(!0), Xe(!0), We(!0), k.events.on("node.remove", function (e) { if ("IMG" == e.get(0).tagName) return qe(e), !1 }), k.events.on("popups.hide.filesManager.insert", function (e) { k.filesManager.minimizePopup(I) }) }, showInsertPopup: U, showLayer: function gt(e) { var t, i, n = k.popups.get("filesManager.insert"); if (h || k.opts.toolbarInline) { if (h) { var a = ft(); ct() && (a = a.find(".fr-img-wrap")), i = a.offset().top + a.outerHeight(), t = a.offset().left } } else { var r = k.$tb.find('.fr-command[data-cmd="insertFiles"]'); t = r.offset().left, i = r.offset().top + (k.opts.toolbarBottom ? 10 : r.outerHeight() - 10) } !h && k.opts.toolbarInline && (i = n.offset().top - k.helpers.getPX(n.css("margin-top")), n.hasClass("fr-above") && (i += n.outerHeight())), n.find(".fr-layer").removeClass("fr-active"), n.find(".fr-".concat(e, "-layer")).addClass("fr-active"), n.find(".fr-upload-progress-layer").addClass("fr-active"), k.popups.show("filesManager.insert", t, i, h ? h.outerHeight() : 0), k.accessibility.focusPopup(n) }, refreshUploadButton: function ut(e) { var t = k.popups.get("filesManager.insert"); t && t.find(".fr-files-upload-layer").hasClass("fr-active") && e.addClass("fr-active").attr("aria-pressed", !0) }, refreshByURLButton: function mt(e) { var t = k.popups.get("filesManager.insert"); t && t.find(".fr-files-by-url-layer").hasClass("fr-active") && e.addClass("fr-active").attr("aria-pressed", !0) }, upload: Re, insertByURL: function vt() { for (var e, t = k.popups.get("filesManager.insert").find(".fr-files-by-url-layer input"), i = t.val().trim().split(/[ ,]+/), n = [], a = 0, r = 0; r < i.length; r++)e = i[r], new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$", "i").test(e) && (n[a] = i[r], a++); if (0 != n.length) { if (0 < t.val().trim().length && 0 < n.length) { var o = [], l = [], d = b, f = n.length; n.forEach(function (e, i) { if (0 == e.trim().length) b == d + --f && Ee(o, l); else { Q(), Z(), J(k.language.translate("Loading file(s)")); var n = e.trim(), t = function s(e) { if (void 0 === e) return e; var t = null; if (/^http/.test(e) || (e = "https://".concat(e)), k.helpers.isURL(e)) for (var i = 0; i < _t.VIDEO_PROVIDERS.length; i++) { var n = _t.VIDEO_PROVIDERS[i]; if (n.test_regex.test(e) && new RegExp(k.opts.videoAllowedProviders.join("|")).test(n.provider)) { t = e.replace(n.url_regex, n.url_text), t = n.html.replace(/\{url\}/, t); break } } return t }(n); if (t) { var a = { link: n, name: n, type: "video/url", size: 2, video: t }; L.set(d + i, a), me(d + i), Q(), Z(), J(k.language.translate("Loading file(s)")), _.set(d + i, a), ++b == d + f && Ee(o, l) } else { var r = new XMLHttpRequest; r.onload = function () { if (200 == this.status) { var e = new Blob([this.response], { type: this.response.type || "" }); e.name = He(n), e.link = n, $e(this.response.type) ? (e.sanitize = !0, e.existing_image = h) : Ue(this.response.type) && (e.text = He(n)), o.push(e), l.push(d + i), L.set(d + i, e), me(d + i), (-1 < O.indexOf(Le(e)) || !Le(e)) && G(C, null, null, d + i) } else { var t = new Blob([this.response], { type: this.response.type || " " }); t.name = He(n), t.link = n, L.set(d + i, t), me(d + i), G(B, this.response, h, d + i) } Q(), Z(), J(k.language.translate("Loading file(s)")), ++b == d + f && Ee(o, l) }, r.onerror = function () { var e = { link: n, name: He(n), size: 0, type: "" }; G(9, this.response, h, d + i); var t = b; L.set(t, e), me(t), Q(), Z(), J(k.language.translate("Loading file(s)")), ++b == d + f && Ee(o, l) }, r.open("GET", "".concat(k.opts.imageCORSProxy, "/").concat(n), !0), r.responseType = "blob", r.send() } } }), t.val(""), t.blur() } } else ee(k.language.translate("Url entered is invalid. Please try again.")) }, insertAllFiles: function ht() { a = []; var e = k.popups.get("filesManager.insert"); v = -1, o = null, e.find(".fr-insert-checkbox").toArray().forEach(function n(e, t, i) { e.children.target.checked && (a.push(parseInt(e.id.split("-").pop())), $e(_.get(parseInt(e.id.split("-").pop())).type) && -1 == v && (v = t)) }), Ie(a), X() }, deleteAllFiles: function e() { k.popups.get("filesManager.insert").find(".fr-insert-checkbox").toArray().forEach(function a(e, t, i) { if (e.children.target.checked) { var n = parseInt(e.id.split("-").pop()); g.has(n) && g["delete"](n), j(n) } }), X() }, get: dt, getEl: ft, insert: _e, showProgressBar: Z, remove: qe, hideProgressBar: Q, applyStyle: function bt(e, t, i) { if (void 0 === t && (t = k.opts.imageStyles), void 0 === i && (i = k.opts.imageMultipleStyles), !h) return !1; var n = ft(); if (!i) { var a = Object.keys(t); a.splice(a.indexOf(e), 1), n.removeClass(a.join(" ")) } "object" == Dt(t[e]) ? (n.removeAttr("style"), n.css(t[e].style)) : n.toggleClass(e), Me(h) }, showAltPopup: Ve, showSizePopup: Ge, setAlt: function yt(e) { if (h) { var t = k.popups.get("image.alt"); h.attr("alt", e || t.find("input").val() || ""), t.find("input:focus").blur(), Me(h) } }, setSize: function wt(e, t) { if (h) { var i = k.popups.get("image.size"); e = e || i.find('input[name="width"]').val() || "", t = t || i.find('input[name="height"]').val() || ""; var n = /^[\d]+((px)|%)*$/g; h.removeAttr("width").removeAttr("height"), e.match(n) ? h.css("width", e) : h.css("width", ""), t.match(n) ? h.css("height", t) : h.css("height", ""), ct() && (h.parents(".fr-img-caption").removeAttr("width").removeAttr("height"), e.match(n) ? h.parents(".fr-img-caption").css("width", e) : h.parents(".fr-img-caption").css("width", ""), t.match(n) ? h.parents(".fr-img-caption").css("height", t) : h.parents(".fr-img-caption").css("height", "")), i && i.find("input:focus").blur(), Me(h) } }, toggleCaption: function xt() { var e; if (h && !ct()) { (e = h).parent().is("a") && (e = h.parent()); var t, i, n = h.parents("ul") && 0 < h.parents("ul").length ? h.parents("ul") : h.parents("ol") && 0 < h.parents("ol").length ? h.parents("ol") : []; if (0 < n.length) { var a = n.find("li").length, r = h.parents("li"), s = document.createElement("li"); a - 1 === r.index() && (n.append(s), s.innerHTML = "&nbsp;") } e.attr("style") && (i = -1 < (t = e.attr("style").split(":")).indexOf("width") ? t[t.indexOf("width") + 1].replace(";", "") : ""); var o = k.opts.imageResizeWithPercent ? (-1 < i.indexOf("px") ? null : i) || "100%" : h.width() + "px"; e.wrap('<div class="fr-img-space-wrap"><span ' + (k.browser.mozilla ? "" : 'contenteditable="false"') + 'class="fr-img-caption ' + h.attr("class") + '" style="' + (k.opts.useClasses ? "" : e.attr("style")) + '" draggable="false"></span><p class="fr-img-space-wrap2">&nbsp;</p></div>'), e.wrap('<span class="fr-img-wrap"></span>'), h.after('<span class="fr-inner"'.concat(k.browser.mozilla ? "" : ' contenteditable="true"', ">").concat(_t.START_MARKER).concat(k.language.translate("Image Caption")).concat(_t.END_MARKER, "</span>")), h.removeAttr("class").removeAttr("style").removeAttr("width"), h.parents(".fr-img-caption").css("width", o), at(!0), k.selection.restore() } else e = ft(), h.insertAfter(e), h.attr("class", e.attr("class").replace("fr-img-caption", "")).attr("style", e.attr("style")), e.remove(), Me(h) }, refreshEmbedButton: function Et(e) { var t = k.popups.get("filesManager.insert"); t && t.find(".fr-files-embed-layer").hasClass("fr-active") && e.addClass("fr-active").attr("aria-pressed", !0) }, insertEmbed: function Mt(e) { void 0 === e && (e = k.popups.get("filesManager.insert").find(".fr-files-embed-layer textarea").val() || ""), 0 === e.length || !_t.VIDEO_EMBED_REGEX.test(e) && !_t.IMAGE_EMBED_REGEX.test(e) ? (ee(k.language.translate("Something went wrong. Please try again.")), _t.VIDEO_EMBED_REGEX.test(e) && k.events.trigger("video.codeError", [e])) : De(e) }, hasCaption: ct, exitEdit: at, edit: Me, cancelFileInsert: function Ct() { this.file_manager_dialog_open = !1, g.forEach(function (e, t) { 4 != e.readyState && (e.abort(), j(t)) }); var e = k.popups.get("filesManager.insert"); e.find(".fr-progress-bar").removeClass("fr-display-block").addClass("fr-none"), e.find('.fr-command[data-cmd="filesUpload"]').removeClass("fr-disabled"), e.find('.fr-command[data-cmd="filesByURL"]').removeClass("fr-disabled"), e.find('.fr-command[data-cmd="filesEmbed"]').removeClass("fr-disabled"), r = 0, g = new Map, u = new Map, q(), k.popups.hide("filesManager.insert") }, minimizePopup: function kt(e) { this.file_manager_dialog_open = !1, k.popups.hide("filesManager.insert"), q() }, editImage: Ae, saveImage: function It(e) { var t = _.get(s); t.link = window.URL.createObjectURL(new Blob(e, { type: "image/png" })), _.set(s, t) }, _showErrorMessage: ee, _showFileErrorMessage: te, getFileThumbnail: be, deleteFile: j, checkAutoplay: Te, checkInsertAllState: X, _disableInsertCheckbox: Y, _getFileType: Le, isChildWindowOpen: function At() { return c }, setChildWindowState: function Lt(e) { e !== undefined && (c = e) }, resetAllFilesCheckbox: q } }, _t.DefineIcon("insertFiles", { NAME: "image", SVG_KEY: "fileManager" }), _t.RegisterShortcut(_t.KEYCODE.P, "insertFiles", null, "P"), _t.RegisterCommand("insertFiles", { title: "Insert Files", undo: !1, focus: !0, refreshAfterCallback: !1, popup: !0, callback: function () { this.popups.isVisible("filesManager.insert") ? (this.$el.find(".fr-marker").length && (this.events.disableBlur(), this.selection.restore()), this.popups.hide("filesManager.insert")) : this.filesManager.showInsertPopup() }, plugin: "filesManager" }), _t.DefineIcon("cloudIcon", { NAME: "cloudIcon", SVG_KEY: "uploadFiles" }), _t.DefineIcon("filesUpload", { NAME: "uploadFiles", SVG_KEY: "uploadFiles" }), _t.RegisterCommand("filesUpload", { title: "Upload Files", undo: !1, focus: !1, toggle: !0, callback: function () { this.filesManager.showLayer("files-upload") }, refresh: function (e) { this.filesManager.refreshUploadButton(e) } }), _t.DefineIcon("filesByURL", { NAME: "link", SVG_KEY: "insertLink" }), _t.RegisterCommand("filesByURL", { title: "By URL", undo: !1, focus: !1, toggle: !0, callback: function () { this.filesManager.showLayer("files-by-url") }, refresh: function (e) { this.filesManager.refreshByURLButton(e) } }), _t.DefineIcon("filesEmbed", { NAME: "code", SVG_KEY: "codeView" }), _t.RegisterCommand("filesEmbed", { title: "Embedded Code", undo: !1, focus: !1, toggle: !0, callback: function () { this.filesManager.showLayer("files-embed") }, refresh: function (e) { this.filesManager.refreshEmbedButton(e) } }), _t.DefineIcon("insertAll", { NAME: "insertAll", SVG_KEY: "fileInsert" }), _t.RegisterCommand("insertAll", { title: "Insert", undo: !1, focus: !1, toggle: !0, disabled: !0, callback: function () { this.filesManager.insertAllFiles() } }), _t.DefineIcon("deleteAll", { NAME: "remove", SVG_KEY: "remove" }), _t.RegisterCommand("deleteAll", { title: "Delete", undo: !1, focus: !1, toggle: !0, disabled: !0, callback: function () { this.filesManager.deleteAllFiles() } }), _t.DefineIcon("cancel", { NAME: "cancel", SVG_KEY: "cancel" }), _t.RegisterCommand("cancel", { title: "Cancel", undo: !1, focus: !1, toggle: !0, callback: function () { this.filesManager.cancelFileInsert() }, refresh: function (e) { } }), _t.DefineIcon("minimize", { NAME: "minimize", SVG_KEY: "minimize" }), _t.RegisterCommand("minimize", { title: "Minimize", undo: !1, focus: !1, toggle: !0, callback: function () { this.filesManager.minimizePopup("image.insert", !0) }, refresh: function (e) { this.filesManager.refreshEmbedButton(e) } }), _t.RegisterCommand("filesInsertByURL", { title: "Insert Image", undo: !0, refreshAfterCallback: !1, callback: function () { this.filesManager.insertByURL() }, refresh: function (e) { e.text(this.language.translate("Add")) } }), _t.RegisterCommand("imageInsertByUpload", { title: "Insert", undo: !0, refreshAfterCallback: !1, callback: function (e, t) { }, refresh: function (e) { } }), _t.RegisterCommand("viewImage", { title: "View Image", undo: !0, refreshAfterCallback: !1, callback: function (e, t) { }, refresh: function (e) { } }), _t.RegisterCommand("insertEmbed", { undo: !0, focus: !0, callback: function () { this.filesManager.insertEmbed(), this.popups.get("filesManager.insert").find("textarea")[0].value = "", this.popups.get("filesManager.insert").find("textarea").removeClass("fr-not-empty") } }), _t.RegisterCommand("filesDismissError", { title: "OK", undo: !1, callback: function () { this.filesManager.hideProgressBar(!0) } }) });